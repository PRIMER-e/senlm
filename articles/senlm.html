<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the `senlm` package • senlm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the `senlm` package">
<meta property="og:description" content="senlm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">senlm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/senlm.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PRIMER-e/senlm/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="senlm_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the <code>senlm</code> package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PRIMER-e/senlm/blob/master/vignettes/senlm.Rmd"><code>vignettes/senlm.Rmd</code></a></small>
      <div class="hidden name"><code>senlm.Rmd</code></div>

    </div>

    
    
<div id="installing-the-senlm-package" class="section level1">
<h1 class="hasAnchor">
<a href="#installing-the-senlm-package" class="anchor"></a>Installing the senlm package</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"PRIMER-e/senlm"</span><span class="op">)</span></code></pre></div>
</div>
<div id="loading-the-senlm-package" class="section level1">
<h1 class="hasAnchor">
<a href="#loading-the-senlm-package" class="anchor"></a>Loading the senlm package</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://primer-e.github.io/senlm/">"senlm"</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="models" class="section level1">
<h1 class="hasAnchor">
<a href="#models" class="anchor"></a>Models</h1>
<p>The models (mean functions and error distributions) described here are for non-negative data. If it is possible to simulate negative data from these models (e.g. Gaussian error) then it is understood that those data points will be set to zero. Also, if a mean function takes a negative value, then the mean function should be set to zero at that location. Any data simulated from a mean function equal to zero, must be zero.</p>
<p>If the data is Bernoulli or percentage data then the data is bounded inclusively between 0 and 1.</p>
<p>If the data is binomial count data, then then the data is bounded inclusively between 0 and <span class="math inline">\(n\)</span>.</p>
<p>The parameters for the mean function are stored in <span class="math inline">\(\theta_M\)</span>, the parameters for the error distribution are stored in <span class="math inline">\(\theta_E\)</span>. The binomial <span class="math inline">\(n\)</span> value, and the <span class="math inline">\(\delta\)</span> parameter of the tail-adjusted beta are stored in <span class="math inline">\(\theta_C\)</span>.</p>
<div id="mean-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#mean-functions" class="anchor"></a>Mean functions</h2>
<p>The available mean functions can be printed via the <tt>mean_function()</tt> function. The mean functions are further classified as being of type <tt>test</tt>, <tt>main</tt>, or <tt>sub</tt>. The <tt>test</tt> class functions are mainly used for testing code, and the <tt>sub</tt> class functions are special cases of the <tt>main</tt> functions.</p>
<table class="table">
<thead><tr class="header">
<th align="left">mean_fun</th>
<th align="left">mean_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">constant</td>
<td align="left">test</td>
</tr>
<tr class="even">
<td align="left">uniform</td>
<td align="left">test</td>
</tr>
<tr class="odd">
<td align="left">beta</td>
<td align="left">main</td>
</tr>
<tr class="even">
<td align="left">sech</td>
<td align="left">main</td>
</tr>
<tr class="odd">
<td align="left">gaussian</td>
<td align="left">main</td>
</tr>
<tr class="even">
<td align="left">mixgaussian</td>
<td align="left">main</td>
</tr>
<tr class="odd">
<td align="left">hofV</td>
<td align="left">main</td>
</tr>
<tr class="even">
<td align="left">sech.p1</td>
<td align="left">sub</td>
</tr>
<tr class="odd">
<td align="left">sech.r0p1</td>
<td align="left">sub</td>
</tr>
<tr class="even">
<td align="left">mixgaussian.equal</td>
<td align="left">sub</td>
</tr>
<tr class="odd">
<td align="left">hofII</td>
<td align="left">sub</td>
</tr>
<tr class="even">
<td align="left">hofIV</td>
<td align="left">sub</td>
</tr>
<tr class="odd">
<td align="left">hofIVb</td>
<td align="left">sub</td>
</tr>
<tr class="even">
<td align="left">hofVb</td>
<td align="left">sub</td>
</tr>
</tbody>
</table>
<p>All mean functions have an <span class="math inline">\(H\)</span> parameter determining the maximum height of the mean function. The range of this parameter depends on the the error distribution (see next section). If the error distribution class is <tt>binary</tt> or <tt>percentage</tt>, then <span class="math inline">\(H\)</span> is between 0 and 1; if the error distribution class <tt>binomial</tt>, then <span class="math inline">\(H\)</span> is between 0 and <span class="math inline">\(n\)</span>; otherwise <span class="math inline">\(H\)</span> must be positive.</p>
<p>The mean functions, <span class="math inline">\(\mu_{\theta_M}(x)\)</span>, are listed below in detail, with parameter descriptions, and their classification in parentheses in the title. The <tt>get_mean_fun_parnames()</tt> output displays the name of the parameters used in the package - sometimes the code uses a simpler roman character rather than a greek spelling e.g. <tt>w</tt> for <span class="math inline">\(\omega\)</span> (<tt>omega</tt>).</p>
<div id="constant-test" class="section level3">
<h3 class="hasAnchor">
<a href="#constant-test" class="anchor"></a><tt>constant</tt> (test)</h3>
<p>The constant mean function.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H\} \\
H &amp;= \mbox{Mean response (}H &gt; 0, ~0 &lt; H &lt; 1, ~0 &lt; H &lt; n) \\
\mu_{\theta_M}(x) &amp;= H \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"constant"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span></span></code></pre></div>
</div>
<div id="uniform-test" class="section level3">
<h3 class="hasAnchor">
<a href="#uniform-test" class="anchor"></a><tt>uniform</tt> (test)</h3>
<p>This mean function is uniform between <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span>, with constant value between <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> of <span class="math inline">\(H\)</span>, and zero elsewhere.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M  &amp;= \{H, c, d\} \\
H &amp;= \mbox{Mean response} ~(H &gt; 0 ~~\mbox{or}~~ 0 &lt; H &lt; 1 ~~\mbox{or}~~ 0 &lt; H &lt; n) \\
c &amp;= \mbox{Lower bound} ~(-\infty &lt; c &lt; \infty) \\
d &amp;= \mbox{Upper bound} ~(-\infty &lt; d &lt; \infty, ~c &lt; d) \\
\mu_{\theta_M}(x) &amp;= H \times 1_{[c,d]}(x) \\
&amp;= \left\{ \begin{array}{cl} 0, &amp; x &lt; c \\
            H, &amp; c \leq x \leq d \\
            0, &amp; x &gt; d \\
           \end{array} \right . 
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"uniform"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"c"</span> <span class="st">"d"</span></span></code></pre></div>
</div>
<div id="beta-main" class="section level3">
<h3 class="hasAnchor">
<a href="#beta-main" class="anchor"></a><tt>beta</tt> (main)</h3>
<p>This mean curve is a modified version of the p.d.f. of a beta distribution. A standard beta distribution p.d.f. has the form:</p>
<p><span class="math display">\[ f(x) = \frac{x^{a-1} (1-x)^{b-1}}{B(a,b)}, \]</span></p>
<p>where <span class="math inline">\(a,b &gt; 0\)</span>, <span class="math inline">\(0 \leq x \leq 1\)</span>, and <span class="math inline">\(B(a,b)\)</span> is the beta function (normalising constant). The density curve takes different shapes as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="right"><span class="math inline">\(a\)</span></th>
<th align="right"><span class="math inline">\(b\)</span></th>
<th align="left">Shape</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(&lt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&lt; 1\)</span></td>
<td align="left">
<span class="math inline">\(U\)</span>-shaped</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(1\)</span></td>
<td align="right"><span class="math inline">\(~~~1\)</span></td>
<td align="left">Uniform</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(2\)</span></td>
<td align="right"><span class="math inline">\(~~~1\)</span></td>
<td align="left">Triangular (positive)</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(1\)</span></td>
<td align="right"><span class="math inline">\(~~~2\)</span></td>
<td align="left">Triangular (negative)</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(&gt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&lt; 1\)</span></td>
<td align="left">
<span class="math inline">\(J\)</span>-shaped (positive)</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(&lt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&gt; 1\)</span></td>
<td align="left">
<span class="math inline">\(J\)</span>-shaped (negative)</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(&gt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&gt; 1\)</span></td>
<td align="left">Unimodal</td>
</tr>
</tbody>
</table>
<p>We modify this by translating the <span class="math inline">\(x\)</span>-domain from <span class="math inline">\((0,1)\)</span> to <span class="math inline">\((c,d)\)</span>, and multiplying by a height parameter <span class="math inline">\(H\)</span>. We also transform the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters to the <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> as follows:</p>
<p><span class="math display">\[ u = \frac{a}{a+b}, ~~~v=\frac{1}{a+b}. \]</span></p>
<p>Under this parameterisation, <span class="math inline">\(u\)</span> (<span class="math inline">\(0&lt;u&lt;1\)</span>) is the mean of the beta distribution, and <span class="math inline">\(v\)</span> (<span class="math inline">\(v&gt;0\)</span>) is a shape parameter. We restrict ourselves to functions that are not <span class="math inline">\(U\)</span> or <span class="math inline">\(J\)</span> shaped (i.e <span class="math inline">\(a \geq 1\)</span>, and <span class="math inline">\(b \geq 1\)</span>).</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, c, d, u, v\} \\
H &amp;= \mbox{Mean response} ~(H &gt; 0 ~~\mbox{or}~~ 0 &lt; H &lt; 1 ~~\mbox{or}~~ 0 &lt; H &lt; n) \\
c &amp;= \mbox{Lower bound} ~(-\infty &lt; c &lt; \infty)  \\
d &amp;= \mbox{Upper bound} ~(-\infty &lt; d &lt; \infty, ~c &lt; d)  \\
u &amp;= \mbox{Mean of the beta distribution} ~(0 &lt; u &lt; 1) \\
v &amp;= \mbox{Shape parameter} ~(v &gt; 0)
~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}\frac{1}{B(a,b)}
\left(\frac{x-c}{d-c}\right)^{a-1}
\left(\frac{d-x}{d-c}\right)^{b-1}
\end{aligned}
\]</span> where <span class="math inline">\(a=\frac{u}{v}\)</span> and <span class="math inline">\(b=\frac{1-u}{v}\)</span>, and <span class="math inline">\(H_m\)</span> is the maximum value of the beta distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"beta"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"c"</span> <span class="st">"d"</span> <span class="st">"u"</span> <span class="st">"v"</span></span></code></pre></div>
</div>
<div id="sech-main" class="section level3">
<h3 class="hasAnchor">
<a href="#sech-main" class="anchor"></a><tt>sech</tt> (main)</h3>
<p>This mean function is a modified sech function. The basic sech function has the following form:</p>
<p><span class="math display">\[ \mbox{sech} (x) = \frac{2}{e^x + e^{-x}}. \]</span></p>
<p>This is a symmetric, unimodal function centered around zero. This function is modified as follows.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, s, r, p\} \\
H &amp;= \mbox{Mean response} ~(H &gt; 0 ~~\mbox{or}~~ 0 &lt; H &lt; 1 ~~\mbox{or}~~ 0 &lt; H &lt; n) \\
m &amp;= \mbox{Mode} ~(-\infty &lt; m &lt; \infty)  \\
s &amp;= \mbox{Spread parameter} ~(s &gt; \infty)  \\
r &amp;= \mbox{Skewness parameter} ~(-1 &lt; r &lt; 1) \\
p &amp;= \mbox{Peakedness parameter} ~(p &gt; 0)
~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\exp\left(\frac{rp}{s}(x - (m-x_m))\right)
\left(\mbox{sech}\left(\frac{x-(m-x_m)}{s}\right)\right)^p
\end{aligned}
\]</span> where <span class="math inline">\(x_m = \frac{s}{2}\log\left(\frac{1+r}{1-r}\right)\)</span> and <span class="math inline">\(H_m = \exp\left(\frac{rp}{s}x_m\right)\left(\sqrt{1 - r^2}\right)^p\)</span> The values <span class="math inline">\(x_m\)</span> and <span class="math inline">\(H_m\)</span> are used to fix the curve so <span class="math inline">\(m\)</span> is the location of the mode, and <span class="math inline">\(H\)</span> is the maximum height of the curve (at <span class="math inline">\(m\)</span>). If <span class="math inline">\(r\)</span> is positive the curve is positively skewed.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"sech"</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span> <span class="st">"r"</span> <span class="st">"p"</span></span></code></pre></div>
</div>
<div id="sech-p1-sub" class="section level3">
<h3 class="hasAnchor">
<a href="#sech-p1-sub" class="anchor"></a><tt>sech.p1</tt> (sub)</h3>
<p>This is the same mean function as <tt>sech</tt> but with <span class="math inline">\(p = 1\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"sech.p1"</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span> <span class="st">"r"</span></span></code></pre></div>
</div>
<div id="sech-r0p1-sub" class="section level3">
<h3 class="hasAnchor">
<a href="#sech-r0p1-sub" class="anchor"></a><tt>sech.r0p1</tt> (sub)</h3>
<p>This is the same mean function as <tt>sech</tt> but with <span class="math inline">\(r = 0\)</span>, and <span class="math inline">\(p = 1\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"sech.r0p1"</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span></span></code></pre></div>
</div>
<div id="gaussian-main" class="section level3">
<h3 class="hasAnchor">
<a href="#gaussian-main" class="anchor"></a><tt>gaussian</tt> (main)</h3>
<p>This mean function is a Gaussian curve with a maximum height <span class="math inline">\(H\)</span>, located at mean/mode <span class="math inline">\(m\)</span>, and a standard deviation of <span class="math inline">\(s\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M  &amp;= \{H, m, s\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
m &amp;= \mbox{Location of maximum of mean function} 
          ~(-\infty &lt; m &lt; \infty)  \\
s &amp;= \mbox{Standard deviation of mean function} ~(s &gt; 0) \\
~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= H \exp\left(-\frac{1}{2}\left(\frac{x-m}{s}\right)^2\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"gaussian"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span></span></code></pre></div>
</div>
<div id="mixgaussian-main" class="section level3">
<h3 class="hasAnchor">
<a href="#mixgaussian-main" class="anchor"></a><tt>mixgaussian</tt> (main)</h3>
<p>This mean function is a mixture of two Gaussian curves. The first component has a maximum height located at mean/mode <span class="math inline">\(m_1\)</span>, with a standard deviation of <span class="math inline">\(s_1\)</span>. Similarly the second component has a maximum height located at mean/mode <span class="math inline">\(m_2\)</span>, with a standard deviation of <span class="math inline">\(s_2\)</span>. The mixture probability is given by <span class="math inline">\(\alpha\)</span>, and the maximum height of the curve is given by <span class="math inline">\(H\)</span>. The condition, <span class="math inline">\(m_1 \leq m_2\)</span>, ensures that component one is always on the left.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, \alpha, m_1, m_2, s_1, s_2\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
\alpha &amp;= \mbox{Mixture probability for first component} ~(0 &lt; \alpha &lt; 1) \\
  m_i &amp;= \mbox{Mean/mode of $i^{th}$ component}
  ~(-\infty &lt; m_i&lt; \infty) \\
  s_i &amp;= \mbox{Standard deviation of $i^{th}$ component} 
   ~(s_i &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}\left\{ \alpha\exp\left(-\frac{1}{2}\left(\frac{x-m_1}{s_1}\right)^2\right) + 
              (1-\alpha)\exp\left(-\frac{1}{2}\left(\frac{x-m_2}{s_2}\right)^2\right)
              \right\}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(H_m\)</span> is the maximum value of the unscaled (<span class="math inline">\(H=1\)</span>) gaussian mixture curve. This is determined numerically.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"mixgaussian"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"a"</span>  <span class="st">"m1"</span> <span class="st">"m2"</span> <span class="st">"s1"</span> <span class="st">"s2"</span></span></code></pre></div>
</div>
<div id="mixgaussian-equal-sub" class="section level3">
<h3 class="hasAnchor">
<a href="#mixgaussian-equal-sub" class="anchor"></a><tt>mixgaussian.equal</tt> (sub)</h3>
<p>This mean function is a the same as the <tt>mixgaussian</tt> mean function, but with the constraint that <span class="math inline">\(s_1 = s_2 ~(=s)\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"mixgaussian.equal"</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"a"</span>  <span class="st">"m1"</span> <span class="st">"m2"</span> <span class="st">"s"</span> </span></code></pre></div>
</div>
<div id="hofv-main" class="section level3">
<h3 class="hasAnchor">
<a href="#hofv-main" class="anchor"></a><tt>hofV</tt> (main)</h3>
<p>This mean function is a scaled product of two sigmoid (logistic) growth curves (one increasing and one decreasing). The growth rates of each curve are <span class="math inline">\(\omega_1\)</span> and <span class="math inline">\(\omega_2\)</span> , and the points of inflection (half height locations) of each curve occur at <span class="math inline">\(m − k\)</span> and <span class="math inline">\(m + k\)</span> respectively.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega_1, \omega_2, k\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Mid-point between points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega_1 &amp;= \mbox{Growth rate parameter of increasing growth curve}
  ~(\omega_1 &gt; 0) \\
  \omega_2 &amp;= \mbox{Growth rate parameter of decreasing growth curve} 
  ~(\omega_2 &gt; 0) \\
  k &amp;= \mbox{Half the distance between points of inflections} ~(k &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\left(\frac{1}{1 + \exp{(-\omega_1(x-(m-k))}}\right)
\left(\frac{1}{1 + \exp{(\omega_2(x-(m+k))}}\right)
\end{aligned}
\]</span></p>
<p>The variable <span class="math inline">\(H_m\)</span> is the maximum value of the unscaled product of the sigmoidal functions. The value of <span class="math inline">\(H_m\)</span> is determined numerically.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofV"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"m"</span>  <span class="st">"w1"</span> <span class="st">"w2"</span> <span class="st">"k"</span> </span></code></pre></div>
</div>
<div id="hofii-sub" class="section level3">
<h3 class="hasAnchor">
<a href="#hofii-sub" class="anchor"></a><tt>hofII</tt> (sub)</h3>
<p>This mean function is a sigmoid (logistic) growth curve with a maximum height of <span class="math inline">\(H\)</span>, a point of inflection <span class="math inline">\(m\)</span>, and a growth rate parameter of <span class="math inline">\(\omega_0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega_0\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Point of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega_0 &amp;= \mbox{Growth rate parameter} ~(-\infty &lt; \omega_0 &lt; \infty) 
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= H\left(\frac{1}{1 + \exp{(-\omega_0(x-m))}}\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofII"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"m"</span>  <span class="st">"w0"</span></span></code></pre></div>
</div>
<div id="hofiv-sub" class="section level3">
<h3 class="hasAnchor">
<a href="#hofiv-sub" class="anchor"></a><tt>hofIV</tt> (sub)</h3>
<p>This mean function is a scaled product of two sigmoid (logistic) growth curves (one increasing and one decreasing). The growth rates of each curve is <span class="math inline">\(\omega\)</span>, and points of inflection (half height locations) of each curve occur at <span class="math inline">\(m − k\)</span> and <span class="math inline">\(m + k\)</span> respectively.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega, k\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Mid-point between points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega &amp;= \mbox{Growth rate parameter} ~(\omega &gt; 0) \\
  k &amp;= \mbox{Half the distance between points of inflections} ~(k &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\left(\frac{1}{1 + \exp{(-\omega(x-(m-k))}}\right)
\left(\frac{1}{1 + \exp{(\omega(x-(m+k))}}\right)
\end{aligned}
\]</span></p>
<p>The variable <span class="math inline">\(H_m\)</span> is the maximum value of the unscaled product of the sigmoidal functions. <span class="math inline">\(H_m = (1 + \exp(−\omega k))^{−2}\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofIV"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"w"</span> <span class="st">"k"</span></span></code></pre></div>
</div>
<div id="hofivb-sub" class="section level3">
<h3 class="hasAnchor">
<a href="#hofivb-sub" class="anchor"></a><tt>hofIVb</tt> (sub)</h3>
<p>This is the same mean function as the <tt>hofIV</tt>, except that <span class="math inline">\(k = 0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Location of points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega &amp;= \mbox{Growth rate parameter} ~(\omega &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{0.25}
\left(\frac{1}{1 + \exp{(-\omega(x-m)}}\right)
\left(\frac{1}{1 + \exp{(\omega(x-m)}}\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofIVb"</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"w"</span></span></code></pre></div>
</div>
<div id="hofvb-sub" class="section level3">
<h3 class="hasAnchor">
<a href="#hofvb-sub" class="anchor"></a><tt>hofVb</tt> (sub)</h3>
<p>This is the same mean function as the <tt>hofV</tt>, except that <span class="math inline">\(k = 0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega_1, \omega_2\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Mid-point between points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega_1 &amp;= \mbox{Growth rate parameter of increasing growth curve}
  ~(\omega_1 &gt; 0) \\
  \omega_2 &amp;= \mbox{Growth rate parameter of decreasing growth curve} 
  ~(\omega_2 &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\left(\frac{1}{1 + \exp{(-\omega_1(x-m)}}\right)
\left(\frac{1}{1 + \exp{(\omega_2(x-m)}}\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofVb"</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"m"</span>  <span class="st">"w1"</span> <span class="st">"w2"</span></span></code></pre></div>
</div>
</div>
<div id="error-disributions" class="section level2">
<h2 class="hasAnchor">
<a href="#error-disributions" class="anchor"></a>Error disributions</h2>
<p>The error distributions are described in this section. Each error distribution is classified as to the type of data it is suited for. This information is shown in the table below.</p>
<table class="table">
<thead><tr class="header">
<th align="left">err_dist</th>
<th align="left">err_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">bernoulli</td>
<td align="left">binary</td>
</tr>
<tr class="even">
<td align="left">binomial.count</td>
<td align="left">binomial</td>
</tr>
<tr class="odd">
<td align="left">binomial.prop</td>
<td align="left">binomial</td>
</tr>
<tr class="even">
<td align="left">poisson</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">negbin</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">zip</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">zinb</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">zipl</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">zinbl</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">zipl.mu</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">zinbl.mu</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">gaussian</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">tweedie</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">zig</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">zigl</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">zigl.mu</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">ziig</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">ziigl</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">ziigl.mu</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">tab</td>
<td align="left">percentage</td>
</tr>
<tr class="odd">
<td align="left">zitab</td>
<td align="left">percentage</td>
</tr>
</tbody>
</table>
<p>In the sections that follow, the value of mean function at the <span class="math inline">\(i^{th}\)</span> observation <span class="math inline">\(x_i\)</span>, is denoted by <span class="math inline">\(\mu_i\)</span>. In other words:</p>
<p><span class="math display">\[ \mu_i = \mu_{\theta_M} (x_i). \]</span></p>
<div id="bernoulli-binary" class="section level3">
<h3 class="hasAnchor">
<a href="#bernoulli-binary" class="anchor"></a><tt>bernoulli</tt> (binary)</h3>
<p>The Bernouli distribution is used for modelling binary data (<span class="math inline">\(0/1\)</span>). The mean function is bounded between 0 and 1. There are no extra parameters for this distribution.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1\} \\
\theta_E &amp;= \{\} \\
P (Y_i = y_i \mid \theta_M, ~\theta_E , ~x_i) 
&amp;\sim \mbox{Bernoulli}(\mu_i) \\
\end{aligned}
\]</span></p>
</div>
<div id="binomial-count-binomial" class="section level3">
<h3 class="hasAnchor">
<a href="#binomial-count-binomial" class="anchor"></a><tt>binomial.count</tt> (binomial)</h3>
<p>The binomial distribution is used for modelling count data that is bounded between 0 and <span class="math inline">\(n\)</span>. The mean function is bounded between 0 and <span class="math inline">\(n\)</span>. There are no extra parameters for this distribution.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, \ldots, n\} \\
\theta_E &amp;= \{\} \\
\theta_C &amp;= \{n\} \\
P (Y_i = y_i \mid ~\theta_M , ~\theta_C , ~x_i) 
&amp;\sim \mbox{Binomial}(n, ~\mu_i) \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">get_constant_parnames</span>(<span class="st">"binomial.count"</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>[<span class="dv">1</span>] <span class="st">"binomial_n"</span></span></code></pre></div>
</div>
<div id="binomial-prop-binomial" class="section level3">
<h3 class="hasAnchor">
<a href="#binomial-prop-binomial" class="anchor"></a><tt>binomial.prop</tt> (binomial)</h3>
<p>This is that same model as the <tt>binomial.count</tt> distribution, except the data recorded as proportions (counts divided by <span class="math inline">\(n\)</span>).</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{\frac{0}{n}, \frac{1}{n}, \ldots, \frac{n}{n}\} \\
\theta_E &amp;= \{\} \\
\theta_C &amp;= \{n\} \\
P (Y_i = ny_i \mid ~\theta_M , ~\theta_C , ~x_i) 
&amp;\sim \mbox{Binomial}(n, ~\mu_i) \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">get_constant_parnames</span>(<span class="st">"binomial.prop"</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>[<span class="dv">1</span>] <span class="st">"binomial_n"</span></span></code></pre></div>
</div>
<div id="poisson-count" class="section level3">
<h3 class="hasAnchor">
<a href="#poisson-count" class="anchor"></a><tt>poisson</tt> (count)</h3>
<p>The Poisson distribution has mean parameter <span class="math inline">\(\lambda=\mu_{\theta_M} (x))\)</span>. There are no extra parameters for this distribution.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\} \\
P (Y_i = y_i \mid \theta_M , ~\theta_E , ~x_i) 
&amp;\sim \mbox{Poisson}(\lambda_i=\mu_i) \\
\end{aligned}
\]</span></p>
</div>
<div id="negbin-count" class="section level3">
<h3 class="hasAnchor">
<a href="#negbin-count" class="anchor"></a><tt>negbin</tt> (count)</h3>
<p>The negative-binomial distribution we use is actually a Gamma-Poisson distribution with the following form:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\lambda_i &amp;\sim \mbox{Gamma}(\mbox{shape}=\alpha, ~\mbox{rate}=\beta_i),\\
  P(Y_i=y_i \mid \lambda_i) &amp;\sim \mbox{Poisson}(\lambda_i) \\
  ~ &amp; ~ \\
\mbox{E}(\lambda_i) &amp;= \frac{\alpha}{\beta_i} \\
\mbox{var}(\lambda_i) &amp;= \frac{\alpha}{\beta_i^2}, \\
\mbox{E}(Y_i) &amp;= \frac{\alpha}{\beta_i} + \frac{\alpha}{\beta_i^2} = \mu_i \\
\mbox{var}(Y_i) &amp;= \frac{\alpha}{\beta_i^2} = \mu_i + \frac{\mu_i^2}{\alpha} = \mu_i + \phi \mu_i^2 \\
\end{aligned}
\]</span> where <span class="math inline">\(\phi = \dfrac{1}{\alpha}\)</span> is the dispersion parameter (<span class="math inline">\(\phi=0\)</span> corresponds to a Poisson distribution), and <span class="math inline">\(\mu_i\)</span> is the mean parameter.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
  \theta_E  &amp;= \{\phi\} \\
  \phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
  P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{Gamma-Poisson}(\mu_i, ~\phi)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"negbin"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>[<span class="dv">1</span>] <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="zip-count" class="section level3">
<h3 class="hasAnchor">
<a href="#zip-count" class="anchor"></a><tt>zip</tt> (count)</h3>
<p>The zero-inflated Poisson (ZIP) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E  &amp;= \{\pi\} \\
\pi &amp;= \mbox{Zero-spike parameter}, (0 \leq \pi \leq 1) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
  &amp;\sim \mbox{ZIP}(\mu_i, ~\pi) \\
  &amp;\sim \left\{\begin{array}{ll}
                 \mbox{Poisson}(\mu_i),
                 &amp; \mbox{w.p.} ~~1-\pi, \\
                 0, &amp; \mbox{w.p.} ~~\pi.
               \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zip"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span></span></code></pre></div>
</div>
<div id="zinb-count" class="section level3">
<h3 class="hasAnchor">
<a href="#zinb-count" class="anchor"></a><tt>zinb</tt> (count)</h3>
<p>The zero-inflated negative-binomial (ZINB) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\pi, \phi\} \\
\pi &amp;= \mbox{Zero-spike parameter} ~(0 \leq \pi \leq 1) \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZINB}(\mu_i, ~\pi, ~\phi) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Gamma-Poisson}(\mu_i, ~\phi),
            &amp; \mbox{w.p.} ~~1-\pi, \\
            0, &amp; \mbox{w.p.} ~~\pi.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zinb"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="zipl-count" class="section level3">
<h3 class="hasAnchor">
<a href="#zipl-count" class="anchor"></a><tt>zipl</tt> (count)</h3>
<p>The zero-inflated Poisson linked (ZIPL) distribution is a Poisson distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, with a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZIPL}(\mu_i, ~\gamma_0, ~\gamma_1) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Poisson}(\mu_i),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zipl"</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span> <span class="st">"g1"</span></span></code></pre></div>
</div>
<div id="zinbl-count" class="section level3">
<h3 class="hasAnchor">
<a href="#zinbl-count" class="anchor"></a><tt>zinbl</tt> (count)</h3>
<p>The zero-inflated negative-binomial linked (ZINBL) distribution is a negative-binomial distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and has zero-spike parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1, \phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZINBL}(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Gamma-Poisson}(\mu_i, ~\phi),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zinbl"</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="zipl-mu-count" class="section level3">
<h3 class="hasAnchor">
<a href="#zipl-mu-count" class="anchor"></a><tt>zipl.mu</tt> (count)</h3>
<p>The zero-inflated Poisson linked-<span class="math inline">\(\mu\)</span> (ZIPL<span class="math inline">\(-\mu\)</span>) distribution is a Poisson distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, with a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZIPL-}\mu(\mu_i, ~\gamma_0, ~\gamma_1) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Poisson}(\mu_i),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zipl.mu"</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span> <span class="st">"g1"</span></span></code></pre></div>
</div>
<div id="zinbl-mu-count" class="section level3">
<h3 class="hasAnchor">
<a href="#zinbl-mu-count" class="anchor"></a><tt>zinbl.mu</tt> (count)</h3>
<p>The zero-inflated negative-binomial linked-<span class="math inline">\(\mu\)</span> (ZINBL-<span class="math inline">\(\mu\)</span>) distribution is a negative-binomial distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and has zero-spike parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1, \phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZINB-}\mu(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Gamma-Poisson}(\mu_i, ~\phi),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zinbl.mu"</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="gaussian-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#gaussian-abundance" class="anchor"></a><tt>gaussian</tt> (abundance)</h3>
<p>The Gaussian distribution has mean parameter <span class="math inline">\(\mu_i\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\sigma\} \\
\sigma &amp;= \mbox{Standard deviation} ~(\sigma &gt; 0) \\
P(Y_i=y_i \mid ~\theta_M, ~\theta_E, ~x_i) 
        &amp;\sim \mbox{Normal}(\mu_i, ~\sigma^2)
\end{aligned}
\]</span> Since our data is non-negative, any data simulated via this model will have negative values set to zero.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"gaussian"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>[<span class="dv">1</span>] <span class="st">"sigma"</span></span></code></pre></div>
</div>
<div id="tweedie-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#tweedie-abundance" class="anchor"></a><tt>tweedie</tt> (abundance)</h3>
<p>Tweedie distributions are a class of exponential dispersion models where the variance is a function of the mean of the form:</p>
<p><span class="math display">\[ \mbox{var}(Y_i) = \phi\mu_i^\rho,\]</span></p>
<p>where <span class="math inline">\(\rho \in (-\infty, 0] \cup [1, \infty)\)</span>. Special cases include the normal (<span class="math inline">\(\rho = 0\)</span>), Poisson (<span class="math inline">\(\rho = 1\)</span>), Gamma (<span class="math inline">\(\rho = 2\)</span>) and inverse Gaussian (<span class="math inline">\(\rho = 3\)</span>) distributions. For <span class="math inline">\(1 &lt; \rho &lt; 2\)</span>, the distributions are continuous for <span class="math inline">\(Y &gt; 0\)</span> and have a discrete mass at <span class="math inline">\(Y = 0\)</span>. We will restrict our attention to <span class="math inline">\(1 &lt; \rho &lt; 2\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\phi, ~\rho\} \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
\rho &amp;= \mbox{Power parameter} ~(1 &lt; \rho &lt; 2) \\
P(Y_i=y_i \mid ~\theta_M, ~\theta_E, ~x_i) 
        &amp;\sim \mbox{Tweedie}(\mu_i, ~\phi, ~\rho) \\
\mbox{E}(Y_i) &amp;= \mu_i \\
\mbox{var}(Y_i) &amp;= \phi(\mu_i)^\rho 
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"tweedie"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>[<span class="dv">1</span>] <span class="st">"phi"</span> <span class="st">"rho"</span></span></code></pre></div>
</div>
<div id="zig-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#zig-abundance" class="anchor"></a><tt>zig</tt> (abundance)</h3>
<p>The zero-inflated Gamma (ZIG) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\pi, ~\phi\} \\
\pi &amp;= \mbox{Zero-spike parameter}, ~(0 \leq \pi \leq 1) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIG}(\mu_i, ~\pi, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi, \\
  0, &amp; \mbox{w.p.} ~~\pi.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^2
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zig"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="zigl-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#zigl-abundance" class="anchor"></a><tt>zigl</tt> (abundance)</h3>
<p>The zero-inflated gamma linked (ZIGL) distribution is a Gamma distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIGL}(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^2
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zigl"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="zigl-mu-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#zigl-mu-abundance" class="anchor"></a><tt>zigl.mu</tt> (abundance)</h3>
<p>The zero-inflated gamma linked-<span class="math inline">\(\mu\)</span> (ZIGL-<span class="math inline">\(\mu\)</span>) distribution is a Gamma distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIGL-}\mu(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^2
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zigl.mu"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="ziig-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#ziig-abundance" class="anchor"></a><tt>ziig</tt> (abundance)</h3>
<p>The zero-inflated inverse-Gaussian (ZIIG) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\pi, ~\phi\} \\
\pi &amp;= \mbox{Zero-spike parameter}, ~(0 \leq \pi \leq 1) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIIG}(\mu_i, ~\pi, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Inverse-Gaussian}(\mu_i, \phi)
  &amp; \mbox{w.p.} ~~1-\pi, \\
  0, &amp; \mbox{w.p.} ~~\pi.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1 - \pi)\mu_i^2 + (1-\pi)\phi\mu_i^3
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"ziig"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="ziigl-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#ziigl-abundance" class="anchor"></a><tt>ziigl</tt> (abundance)</h3>
<p>The zero-inflated inverse-Gaussian linked (ZIIGL) distribution is an inverse-Gaussian distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIIGL}(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^3
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"ziigl"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="ziigl-mu-abundance" class="section level3">
<h3 class="hasAnchor">
<a href="#ziigl-mu-abundance" class="anchor"></a><tt>ziigl.mu</tt> (abundance)</h3>
<p>The zero-inflated inverse-Gaussian linked-<span class="math inline">\(\mu\)</span> (ZIIGL-<span class="math inline">\(\mu\)</span>) distribution is an inverse-Gaussian distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIIGL-}\mu(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^3
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"ziigl.mu"</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div id="tab-percentage" class="section level3">
<h3 class="hasAnchor">
<a href="#tab-percentage" class="anchor"></a><tt>tab</tt> (percentage)</h3>
<p>The tail-adjusted beta (TAB) distribution is a beta distribution where values less than <span class="math inline">\(\delta\)</span> are rounded down to zero, and values greater than <span class="math inline">\(1-\delta\)</span> are rounded up to one. This is used to model data that is between 0 and 1 (inclusive).</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in [0,1] \\
\theta_E &amp;= \{\sigma\} \\
\theta_C &amp;= \{\delta\} \\
\sigma &amp;= \mbox{Shape parameter}, (\sigma &gt; 0) \\
\delta &amp;= \mbox{Rounding parameter}, (0 &lt; \delta &lt; \frac{1}{2}) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~\theta_C, ~x_i) 
&amp;\sim \mbox{TAB}(\mu_i, ~\sigma, ~\delta) \\
&amp;\sim \left\{\begin{array}{ll}
\frac{p^{(0)}_i}{\delta} &amp; y_i &lt; \delta \\
\dfrac{y_i^{\alpha_i-1}(1-y_i)^{\beta-1}}{B(\alpha,\beta)}
&amp; \delta &lt; y_i &lt; 1 - \delta \\
\frac{p^{(1)}_i}{\delta} &amp; y_i &gt; 1 - \delta \\
\end{array}\right.\\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(p^{(0)}_i\)</span> is the probability the Beta(<span class="math inline">\(\alpha_i, ~\beta)\)</span> distribution is less than <span class="math inline">\(\delta\)</span>, and <span class="math inline">\(p^{(1)}_i\)</span> is the probability the Beta(<span class="math inline">\(\alpha_i, ~\beta)\)</span> distribution is greater than <span class="math inline">\(1 - \delta\)</span>. The parameters of the TAB (<span class="math inline">\(\mu_i\)</span>, <span class="math inline">\(\sigma\)</span>) are converted to beta distribution parameters (<span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta\)</span>) and back again as follows: <span class="math display">\[
\begin{aligned}
\mu_i &amp;= \dfrac{\alpha_i}{\alpha_i + \beta}, &amp;~
\sigma &amp;= \dfrac{1}{\alpha_i + \beta} \\
\alpha &amp; = \dfrac{\mu_i}{\sigma}, &amp;~ \beta &amp;= \dfrac{1 - \mu_i}{\sigma}
\end{aligned}
\]</span></p>
<p>We restrict ourselves to <span class="math inline">\(\alpha_i \geq 1\)</span> and <span class="math inline">\(\beta \geq 1\)</span> (uniform, triangular, and unimodal shapes).</p>
<p>The <span class="math inline">\(\delta\)</span> parameter is not estimated via maximum likelihood like other parameters, it is estimated as the minimum of: the smallest non-zero <span class="math inline">\(y_i\)</span>, and one minus the largest non-one <span class="math inline">\(y_i\)</span>. In other words:</p>
<p><span class="math display">\[ \hat{\delta} = \min( \min_i(y_i : y_i&gt;0), ~\min_i(1-y_i : y_i &lt; 1) ). \]</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"tab"</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>[<span class="dv">1</span>] <span class="st">"sigma"</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">get_constant_parnames</span>(<span class="st">"tab"</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a>[<span class="dv">1</span>] <span class="st">"delta"</span></span></code></pre></div>
</div>
<div id="zitab-percentage" class="section level3">
<h3 class="hasAnchor">
<a href="#zitab-percentage" class="anchor"></a><tt>zitab</tt> (percentage)</h3>
<p>The zero-inflated tail-adjusted Beta (ZITAB) distribution is the tail-adjusted beta distribution with a zero-inflated spike added.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in [0,1] \\
\theta_E &amp;= \{\pi, ~\sigma\} \\
\theta_C &amp;= \{\delta\} \\
\pi &amp;= \mbox{Zero-spike parameter}, ~(0 \leq \pi \leq 1) \\
\sigma &amp;= \mbox{Shape parameter}, (\sigma &gt; 0) \\
\delta &amp;= \mbox{Rounding parameter}, (0 &lt; \delta &lt; \frac{1}{2}) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~\theta_C, ~x_i) 
            &amp;\sim \mbox{ZITAB}(\mu_i, ~\pi, ~\sigma, ~\delta) \\
            &amp;\sim \left\{\begin{array}{ll}
            \pi + (1-\pi)p^{(0)}_i &amp; y_i &lt; \delta \\
            (1-\pi)\dfrac{y_i^{\alpha_i-1}(1-y_i)^{\beta-1}}{B(\alpha,\beta)}
            &amp; \delta &lt; y_i &lt; 1 - \delta \\
            (1-\pi)p^{(1)}_i &amp; y_i &gt; 1 - \delta \\
            \end{array}\right.\\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zitab"</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>    <span class="st">"sigma"</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">get_constant_parnames</span>(<span class="st">"zitab"</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a>[<span class="dv">1</span>] <span class="st">"delta"</span></span></code></pre></div>
</div>
</div>
</div>
<div id="fitting-models" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-models" class="anchor"></a>Fitting models</h1>
<div id="setting-models-to-fit" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-models-to-fit" class="anchor"></a>Setting models to fit</h2>
<p>The <tt>set_models()</tt> function is used to create a data frame that contains the mean functions, error distributions, and if appropriate the binomial <span class="math inline">\(n\)</span> parameter, of all models that one would wish to fit or simulate data from.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">## All possible combinations of mean functions and error distrbiutions</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="kw">c</span>(<span class="st">"gaussian"</span>, <span class="st">"beta"</span>), <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"zinb"</span>, <span class="st">"zinbl"</span>),</span>
<span id="cb36-3"><a href="#cb36-3"></a>            <span class="dt">method=</span><span class="st">"crossed"</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a>  mean_fun err_dist binomial_n</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="dv">1</span>     beta     zinb         <span class="ot">NA</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="dv">2</span>     beta    zinbl         <span class="ot">NA</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="dv">3</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="dv">4</span> gaussian    zinbl         <span class="ot">NA</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="co">## Fit specific models</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="kw">c</span>(<span class="st">"gaussian"</span>, <span class="st">"beta"</span>), <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"zinb"</span>, <span class="st">"zinbl"</span>),</span>
<span id="cb36-11"><a href="#cb36-11"></a>            <span class="dt">method=</span><span class="st">"paired"</span>)</span>
<span id="cb36-12"><a href="#cb36-12"></a>  mean_fun err_dist binomial_n</span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="dv">1</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="dv">2</span>     beta    zinbl         <span class="ot">NA</span></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="co">## Fit binomial model - with n=40</span></span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="kw">c</span>(<span class="st">"gaussian"</span>), </span>
<span id="cb36-17"><a href="#cb36-17"></a>            <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"poisson"</span>, <span class="st">"binomial.prop"</span>, <span class="st">"binomial.count"</span>),</span>
<span id="cb36-18"><a href="#cb36-18"></a>            <span class="dt">binomial_n=</span><span class="dv">40</span>, <span class="dt">method=</span><span class="st">"paired"</span>)</span>
<span id="cb36-19"><a href="#cb36-19"></a>  mean_fun       err_dist binomial_n</span>
<span id="cb36-20"><a href="#cb36-20"></a><span class="dv">1</span> gaussian        poisson         <span class="ot">NA</span></span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="dv">2</span> gaussian  binomial.prop         <span class="dv">40</span></span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="dv">3</span> gaussian binomial.count         <span class="dv">40</span></span>
<span id="cb36-23"><a href="#cb36-23"></a><span class="co">## Can also specify via mean and error class</span></span>
<span id="cb36-24"><a href="#cb36-24"></a><span class="kw">set_models</span> (<span class="dt">mean_class=</span><span class="st">"main"</span>, <span class="dt">err_class=</span><span class="st">"percentage"</span>)</span>
<span id="cb36-25"><a href="#cb36-25"></a>      mean_fun err_dist binomial_n</span>
<span id="cb36-26"><a href="#cb36-26"></a><span class="dv">1</span>         beta      tab         <span class="ot">NA</span></span>
<span id="cb36-27"><a href="#cb36-27"></a><span class="dv">2</span>         beta    zitab         <span class="ot">NA</span></span>
<span id="cb36-28"><a href="#cb36-28"></a><span class="dv">3</span>     gaussian      tab         <span class="ot">NA</span></span>
<span id="cb36-29"><a href="#cb36-29"></a><span class="dv">4</span>     gaussian    zitab         <span class="ot">NA</span></span>
<span id="cb36-30"><a href="#cb36-30"></a><span class="dv">5</span>         hofV      tab         <span class="ot">NA</span></span>
<span id="cb36-31"><a href="#cb36-31"></a><span class="dv">6</span>         hofV    zitab         <span class="ot">NA</span></span>
<span id="cb36-32"><a href="#cb36-32"></a><span class="dv">7</span>  mixgaussian      tab         <span class="ot">NA</span></span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="dv">8</span>  mixgaussian    zitab         <span class="ot">NA</span></span>
<span id="cb36-34"><a href="#cb36-34"></a><span class="dv">9</span>         sech      tab         <span class="ot">NA</span></span>
<span id="cb36-35"><a href="#cb36-35"></a><span class="dv">10</span>        sech    zitab         <span class="ot">NA</span></span></code></pre></div>
</div>
<div id="simulated-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-data" class="anchor"></a>Simulated data</h2>
<p>This section describes how to simulate data sets for any possible model. The <tt>create_default_par_list()</tt> function set default parameter values for each selected model.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## --- Set models</span>
<span class="va">Models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_models.html">set_models</a></span> <span class="op">(</span>mean_fun<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gaussian"</span><span class="op">)</span>, err_dist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"zip"</span>, <span class="st">"zinb"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## --- Set default parameters list</span>
<span class="va">Pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_default_par_list.html">create_default_par_list</a></span> <span class="op">(</span><span class="va">Models</span><span class="op">)</span>

<span class="co">## --- Simulate data</span>
<span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_simulated_datasets.html">create_simulated_datasets</a></span> <span class="op">(</span><span class="va">Pars</span>, N<span class="op">=</span><span class="fl">200</span>, xmin<span class="op">=</span><span class="fl">0</span>, xmax<span class="op">=</span><span class="fl">100</span>, seed<span class="op">=</span><span class="fl">12345</span><span class="op">)</span></code></pre></div>
<p>This code creates simulates data for the <tt>gaussian-zip</tt>, and <tt>gaussian-zinb</tt> models. The objects <tt>Pars</tt> is a list containing parameters for each model. The object <tt>Data</tt> is a list containing the data for each model; <tt>Data[[1]]</tt> is the data for the first model, etc.</p>
</div>
<div id="real-data" class="section level2">
<h2 class="hasAnchor">
<a href="#real-data" class="anchor"></a>Real data</h2>
<p>The <tt>senlm</tt> packages contains the following data sets:</p>
<ul>
<li><tt>haul</tt></li>
</ul>
<p>The first few rows of data are shown below.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">data</span>(haul, <span class="dt">package=</span><span class="st">"senlm"</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">head</span> (haul)</span>
<span id="cb38-3"><a href="#cb38-3"></a>     year    depth lattitude Albatrossia.pectoralis Sebastolobus.altivelis</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="dv">1717</span> <span class="dv">2003</span> <span class="fl">527.5357</span>  <span class="fl">46.30425</span>                      <span class="dv">0</span>                     <span class="dv">37</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="dv">1718</span> <span class="dv">2003</span> <span class="fl">673.7497</span>  <span class="fl">46.73217</span>                      <span class="dv">0</span>                    <span class="dv">397</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="dv">1719</span> <span class="dv">2003</span> <span class="fl">276.1650</span>  <span class="fl">46.71926</span>                      <span class="dv">0</span>                      <span class="dv">0</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="dv">1720</span> <span class="dv">2003</span> <span class="fl">823.6656</span>  <span class="fl">46.92419</span>                      <span class="dv">3</span>                    <span class="dv">711</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="dv">1721</span> <span class="dv">2003</span> <span class="fl">172.6837</span>  <span class="fl">47.01439</span>                      <span class="dv">0</span>                      <span class="dv">0</span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="dv">1722</span> <span class="dv">2003</span> <span class="fl">985.7053</span>  <span class="fl">47.56385</span>                     <span class="dv">18</span>                    <span class="dv">534</span></span></code></pre></div>
</div>
<div id="fitting-models-to-data" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-models-to-data" class="anchor"></a>Fitting models to data</h2>
<p>To fit one model to a data set we use the <tt>senlm()</tt> function. We illustrate this with the <tt>haul</tt> dataset.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>Fit &lt;-<span class="st"> </span><span class="kw">senlm</span> (<span class="dt">data=</span>haul, <span class="dt">xvar=</span><span class="st">"depth"</span>, <span class="dt">yvar=</span><span class="st">"Sebastolobus.altivelis"</span>, </span>
<span id="cb39-2"><a href="#cb39-2"></a>              <span class="dt">mean_fun=</span><span class="st">"gaussian"</span>, <span class="dt">err_dist=</span><span class="st">"zip"</span>, <span class="dt">conf.level=</span><span class="fl">0.95</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="kw">summary</span> (Fit)</span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="op">$</span>model</span>
<span id="cb39-5"><a href="#cb39-5"></a>[<span class="dv">1</span>] <span class="st">"gaussian_zip"</span></span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="op">$</span>theta</span>
<span id="cb39-8"><a href="#cb39-8"></a>          H           m           s          pi </span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="fl">817.5307514</span> <span class="fl">917.8020524</span> <span class="fl">225.5627510</span>   <span class="fl">0.5954255</span> </span>
<span id="cb39-10"><a href="#cb39-10"></a></span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="op">$</span>IC</span>
<span id="cb39-12"><a href="#cb39-12"></a>    npar      nll      AIC     AICc      BIC </span>
<span id="cb39-13"><a href="#cb39-13"></a>    <span class="fl">4.00</span> <span class="fl">36950.05</span> <span class="fl">73908.10</span> <span class="fl">73908.14</span> <span class="fl">73928.01</span> </span></code></pre></div>
<p>Confidence intervals for the estimated parameters can be display as follows. The default confidence level is 95% which is set when fitting the model. Occasionly due to numerical instability of the estimated Hessian matrix the standard errors are not calculated.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">rbind</span> (<span class="dt">lower=</span>Fit<span class="op">$</span>lb, <span class="dt">upper=</span>Fit<span class="op">$</span>ub)</span>
<span id="cb40-2"><a href="#cb40-2"></a>             H        m        s        pi</span>
<span id="cb40-3"><a href="#cb40-3"></a>lower <span class="fl">812.7322</span> <span class="fl">916.2962</span> <span class="fl">224.2579</span> <span class="fl">0.5615010</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>upper <span class="fl">822.3576</span> <span class="fl">919.3079</span> <span class="fl">226.8752</span> <span class="fl">0.6284622</span></span></code></pre></div>
<p>To fit multiple models to multiple data sets, one can use the <tt>msenlm()</tt> function. The models to fit are specified with the <tt>set_models()</tt> function. The data should be stored in a list. It could be simulated data create using the <tt>create_simulated_datasets()</tt> function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>Models &lt;-<span class="st"> </span><span class="kw">set_models</span> (<span class="dt">mean_class=</span><span class="st">"test"</span>, <span class="dt">err_class=</span><span class="st">"binary"</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a>Pars   &lt;-<span class="st"> </span><span class="kw">create_default_par_list</span> (<span class="dt">models=</span>Models)</span>
<span id="cb41-3"><a href="#cb41-3"></a>Data   &lt;-<span class="st"> </span><span class="kw">create_simulated_datasets</span> (Pars, <span class="dt">seed=</span><span class="dv">12345</span>)</span>
<span id="cb41-4"><a href="#cb41-4"></a>Fits   &lt;-<span class="st"> </span><span class="kw">msenlm</span> (<span class="dt">models=</span>Models, <span class="dt">data=</span>Data, <span class="dt">xvar=</span><span class="st">"x"</span>, <span class="dt">yvar=</span><span class="kw">names</span>(Data)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb41-5"><a href="#cb41-5"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="dv">1</span> constant bernoulli         <span class="ot">NA</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="dv">2</span>  uniform bernoulli         <span class="ot">NA</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="dv">1</span> constant bernoulli         <span class="ot">NA</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="dv">2</span>  uniform bernoulli         <span class="ot">NA</span></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="kw">print</span> (Models)</span>
<span id="cb41-14"><a href="#cb41-14"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="dv">1</span> constant bernoulli         <span class="ot">NA</span></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="dv">2</span>  uniform bernoulli         <span class="ot">NA</span></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="kw">summary</span> (Fits)</span>
<span id="cb41-18"><a href="#cb41-18"></a>  convergence                  y x              model mean_fun  err_dist         H         c</span>
<span id="cb41-19"><a href="#cb41-19"></a><span class="dv">1</span>           <span class="dv">0</span> constant_bernoulli x constant_bernoulli constant bernoulli <span class="fl">0.9320000</span>        <span class="ot">NA</span></span>
<span id="cb41-20"><a href="#cb41-20"></a><span class="dv">2</span>           <span class="dv">0</span> constant_bernoulli x  uniform_bernoulli  uniform bernoulli <span class="fl">0.9320000</span> <span class="fl">-3.942373</span></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="dv">3</span>           <span class="dv">0</span>  uniform_bernoulli x constant_bernoulli constant bernoulli <span class="fl">0.3540000</span>        <span class="ot">NA</span></span>
<span id="cb41-22"><a href="#cb41-22"></a><span class="dv">4</span>           <span class="dv">0</span>  uniform_bernoulli x  uniform_bernoulli  uniform bernoulli <span class="fl">0.9030612</span> <span class="fl">30.480317</span></span>
<span id="cb41-23"><a href="#cb41-23"></a>          d npar       nll      AIC     AICc      BIC</span>
<span id="cb41-24"><a href="#cb41-24"></a><span class="dv">1</span>        <span class="ot">NA</span>    <span class="dv">1</span> <span class="fl">124.21729</span> <span class="fl">250.4346</span> <span class="fl">250.4426</span> <span class="fl">254.6492</span></span>
<span id="cb41-25"><a href="#cb41-25"></a><span class="dv">2</span> <span class="fl">109.72818</span>    <span class="dv">3</span> <span class="fl">124.21729</span> <span class="fl">254.4346</span> <span class="fl">254.4830</span> <span class="fl">267.0784</span></span>
<span id="cb41-26"><a href="#cb41-26"></a><span class="dv">3</span>        <span class="ot">NA</span>    <span class="dv">1</span> <span class="fl">324.94385</span> <span class="fl">651.8877</span> <span class="fl">651.8957</span> <span class="fl">656.1023</span></span>
<span id="cb41-27"><a href="#cb41-27"></a><span class="dv">4</span>  <span class="fl">69.92645</span>    <span class="dv">3</span>  <span class="fl">62.38763</span> <span class="fl">130.7753</span> <span class="fl">130.8236</span> <span class="fl">143.4191</span></span></code></pre></div>
<p>Alternatively, one can fit multiple models to real data. The <tt>msenlm.best</tt> function picks the best model for each response variable using the given criteria. The <tt>summary</tt> function summarises the fitted models.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>Models &lt;-<span class="st"> </span><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="st">"gaussian"</span>, <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"zip"</span>, <span class="st">"zinb"</span>))</span>
<span id="cb42-2"><a href="#cb42-2"></a>Fits   &lt;-<span class="st"> </span><span class="kw">msenlm</span> (<span class="dt">models=</span>Models, <span class="dt">data=</span>haul, <span class="dt">xvar=</span><span class="st">"depth"</span>, </span>
<span id="cb42-3"><a href="#cb42-3"></a>                  <span class="dt">yvar=</span><span class="kw">c</span>(<span class="st">"Albatrossia.pectoralis"</span>, <span class="st">"Sebastolobus.altivelis"</span>))</span>
<span id="cb42-4"><a href="#cb42-4"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="dv">1</span> gaussian      zip         <span class="ot">NA</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="dv">2</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="dv">1</span> gaussian      zip         <span class="ot">NA</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="dv">2</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="kw">summary</span>(Fits)</span>
<span id="cb42-13"><a href="#cb42-13"></a>  convergence                      y     x         model mean_fun err_dist          H         m</span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="dv">1</span>           <span class="dv">0</span> Albatrossia.pectoralis depth  gaussian_zip gaussian      zip   <span class="fl">58.11774</span> <span class="fl">1537.8443</span></span>
<span id="cb42-15"><a href="#cb42-15"></a><span class="dv">2</span>           <span class="dv">0</span> Albatrossia.pectoralis depth gaussian_zinb gaussian     zinb   <span class="fl">29.74406</span> <span class="fl">1145.7279</span></span>
<span id="cb42-16"><a href="#cb42-16"></a><span class="dv">3</span>           <span class="dv">0</span> Sebastolobus.altivelis depth  gaussian_zip gaussian      zip  <span class="fl">817.53075</span>  <span class="fl">917.8021</span></span>
<span id="cb42-17"><a href="#cb42-17"></a><span class="dv">4</span>           <span class="dv">0</span> Sebastolobus.altivelis depth gaussian_zinb gaussian     zinb <span class="fl">1448.37032</span>  <span class="fl">900.6964</span></span>
<span id="cb42-18"><a href="#cb42-18"></a>         s            pi      phi npar        nll       AIC      AICc       BIC</span>
<span id="cb42-19"><a href="#cb42-19"></a><span class="dv">1</span> <span class="fl">369.7512</span>  <span class="fl">4.303471e-01</span>       <span class="ot">NA</span>    <span class="dv">4</span>  <span class="fl">3022.4148</span>  <span class="fl">6052.830</span>  <span class="fl">6052.867</span>  <span class="fl">6072.739</span></span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="dv">2</span> <span class="fl">213.8882</span> <span class="fl">1.048578e-200</span> <span class="fl">3.044748</span>    <span class="dv">5</span>   <span class="fl">927.2072</span>  <span class="fl">1864.414</span>  <span class="fl">1864.471</span>  <span class="fl">1889.301</span></span>
<span id="cb42-21"><a href="#cb42-21"></a><span class="dv">3</span> <span class="fl">225.5628</span>  <span class="fl">5.954251e-01</span>       <span class="ot">NA</span>    <span class="dv">4</span> <span class="fl">36950.0517</span> <span class="fl">73908.103</span> <span class="fl">73908.141</span> <span class="fl">73928.013</span></span>
<span id="cb42-22"><a href="#cb42-22"></a><span class="dv">4</span> <span class="fl">164.9688</span>  <span class="fl">1.548456e-01</span> <span class="fl">1.575697</span>    <span class="dv">5</span>  <span class="fl">2910.8488</span>  <span class="fl">5831.698</span>  <span class="fl">5831.754</span>  <span class="fl">5856.584</span></span>
<span id="cb42-23"><a href="#cb42-23"></a><span class="kw">summary</span>(<span class="kw">msenlm.best</span>(Fits, <span class="dt">best=</span><span class="st">"AICc"</span>))</span>
<span id="cb42-24"><a href="#cb42-24"></a>  convergence                      y     x         model mean_fun err_dist          H         m</span>
<span id="cb42-25"><a href="#cb42-25"></a><span class="dv">1</span>           <span class="dv">0</span> Albatrossia.pectoralis depth gaussian_zinb gaussian     zinb   <span class="fl">29.74406</span> <span class="fl">1145.7279</span></span>
<span id="cb42-26"><a href="#cb42-26"></a><span class="dv">2</span>           <span class="dv">0</span> Sebastolobus.altivelis depth gaussian_zinb gaussian     zinb <span class="fl">1448.37032</span>  <span class="fl">900.6964</span></span>
<span id="cb42-27"><a href="#cb42-27"></a>         s            pi      phi npar       nll      AIC     AICc      BIC</span>
<span id="cb42-28"><a href="#cb42-28"></a><span class="dv">1</span> <span class="fl">213.8882</span> <span class="fl">1.048578e-200</span> <span class="fl">3.044748</span>    <span class="dv">5</span>  <span class="fl">927.2072</span> <span class="fl">1864.414</span> <span class="fl">1864.471</span> <span class="fl">1889.301</span></span>
<span id="cb42-29"><a href="#cb42-29"></a><span class="dv">2</span> <span class="fl">164.9688</span>  <span class="fl">1.548456e-01</span> <span class="fl">1.575697</span>    <span class="dv">5</span> <span class="fl">2910.8488</span> <span class="fl">5831.698</span> <span class="fl">5831.754</span> <span class="fl">5856.584</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Walsh, Marti Anderson, Andrew Punnett, Nurudeen Adegoke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
