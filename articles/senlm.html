<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the `senlm` package • senlm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the `senlm` package">
<meta property="og:description" content="senlm">
<meta property="og:image" content="https://primer-e.github.io/senlm/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">senlm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/senlm.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/beta.html">Beta</a>
    </li>
    <li>
      <a href="../articles/constant.html">Constant</a>
    </li>
    <li>
      <a href="../articles/modskurt.html">ModSkurt</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PRIMER-e/senlm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="senlm_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the <code>senlm</code> package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PRIMER-e/senlm/blob/HEAD/vignettes/senlm.Rmd" class="external-link"><code>vignettes/senlm.Rmd</code></a></small>
      <div class="hidden name"><code>senlm.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="installing-the-senlm-package">Installing the senlm package<a class="anchor" aria-label="anchor" href="#installing-the-senlm-package"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"PRIMER-e/senlm"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-the-senlm-package">Loading the senlm package<a class="anchor" aria-label="anchor" href="#loading-the-senlm-package"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://primer-e.github.io/senlm/">"senlm"</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<p>The models (mean functions and error distributions) described here are for non-negative data. If it is possible to simulate negative data from these models (e.g. Gaussian error) then it is understood that those data points will be set to zero. Also, if a mean function takes a negative value, then the mean function should be set to zero at that location. Any data simulated from a mean function equal to zero, must be zero.</p>
<p>If the data is Bernoulli or percentage data then the data is bounded inclusively between 0 and 1.</p>
<p>If the data is binomial count data, then then the data is bounded inclusively between 0 and <span class="math inline">\(n\)</span>.</p>
<p>The parameters for the mean function are stored in <span class="math inline">\(\theta_M\)</span>, the parameters for the error distribution are stored in <span class="math inline">\(\theta_E\)</span>. The binomial <span class="math inline">\(n\)</span> value, and the <span class="math inline">\(\delta\)</span> parameter of the tail-adjusted beta are stored in <span class="math inline">\(\theta_C\)</span>.</p>
<div class="section level3">
<h3 id="mean-functions">Mean functions<a class="anchor" aria-label="anchor" href="#mean-functions"></a>
</h3>
<p>The available mean functions can be printed via the <tt>mean_function()</tt> function. The mean functions are further classified as being of type <tt>test</tt>, <tt>main</tt>, or <tt>sub</tt>. The <tt>test</tt> class functions are mainly used for testing code, and the <tt>sub</tt> class functions are special cases of the <tt>main</tt> functions.</p>
<table class="table">
<thead><tr class="header">
<th align="left">mean_fun</th>
<th align="left">mean_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">constant</td>
<td align="left">test</td>
</tr>
<tr class="even">
<td align="left">uniform</td>
<td align="left">test</td>
</tr>
<tr class="odd">
<td align="left">beta</td>
<td align="left">main</td>
</tr>
<tr class="even">
<td align="left">sech</td>
<td align="left">main</td>
</tr>
<tr class="odd">
<td align="left">gaussian</td>
<td align="left">main</td>
</tr>
<tr class="even">
<td align="left">mixgaussian</td>
<td align="left">main</td>
</tr>
<tr class="odd">
<td align="left">hofV</td>
<td align="left">main</td>
</tr>
<tr class="even">
<td align="left">sech.p1</td>
<td align="left">sub</td>
</tr>
<tr class="odd">
<td align="left">sech.r0p1</td>
<td align="left">sub</td>
</tr>
<tr class="even">
<td align="left">mixgaussian.equal</td>
<td align="left">sub</td>
</tr>
<tr class="odd">
<td align="left">hofII</td>
<td align="left">sub</td>
</tr>
<tr class="even">
<td align="left">hofIV</td>
<td align="left">sub</td>
</tr>
<tr class="odd">
<td align="left">hofIVb</td>
<td align="left">sub</td>
</tr>
<tr class="even">
<td align="left">hofVb</td>
<td align="left">sub</td>
</tr>
</tbody>
</table>
<p>All mean functions have an <span class="math inline">\(H\)</span> parameter determining the maximum height of the mean function. The range of this parameter depends on the the error distribution (see next section). If the error distribution class is <tt>binary</tt> or <tt>percentage</tt>, then <span class="math inline">\(H\)</span> is between 0 and 1; if the error distribution class <tt>binomial</tt>, then <span class="math inline">\(H\)</span> is between 0 and <span class="math inline">\(n\)</span>; otherwise <span class="math inline">\(H\)</span> must be positive.</p>
<p>The mean functions, <span class="math inline">\(\mu_{\theta_M}(x)\)</span>, are listed below in detail, with parameter descriptions, and their classification in parentheses in the title. The <tt>get_mean_fun_parnames()</tt> output displays the name of the parameters used in the package - sometimes the code uses a simpler roman character rather than a greek spelling e.g. <tt>w</tt> for <span class="math inline">\(\omega\)</span> (<tt>omega</tt>).</p>
<div class="section level4">
<h4 id="constant-test">
<tt>constant</tt> (test)<a class="anchor" aria-label="anchor" href="#constant-test"></a>
</h4>
<p>The constant mean function.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H\} \\
H &amp;= \mbox{Mean response (}H &gt; 0, ~0 &lt; H &lt; 1, ~0 &lt; H &lt; n) \\
\mu_{\theta_M}(x) &amp;= H \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"constant"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="uniform-test">
<tt>uniform</tt> (test)<a class="anchor" aria-label="anchor" href="#uniform-test"></a>
</h4>
<p>This mean function is uniform between <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span>, with constant value between <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> of <span class="math inline">\(H\)</span>, and zero elsewhere.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M  &amp;= \{H, c, d\} \\
H &amp;= \mbox{Mean response} ~(H &gt; 0 ~~\mbox{or}~~ 0 &lt; H &lt; 1 ~~\mbox{or}~~ 0 &lt; H &lt; n) \\
c &amp;= \mbox{Lower bound} ~(-\infty &lt; c &lt; \infty) \\
d &amp;= \mbox{Upper bound} ~(-\infty &lt; d &lt; \infty, ~c &lt; d) \\
\mu_{\theta_M}(x) &amp;= H \times 1_{[c,d]}(x) \\
&amp;= \left\{ \begin{array}{cl} 0, &amp; x &lt; c \\
            H, &amp; c \leq x \leq d \\
            0, &amp; x &gt; d \\
           \end{array} \right . 
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"uniform"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"c"</span> <span class="st">"d"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="beta-main">
<tt>beta</tt> (main)<a class="anchor" aria-label="anchor" href="#beta-main"></a>
</h4>
<p>This mean curve is a modified version of the p.d.f. of a beta distribution. A standard beta distribution p.d.f. has the form:</p>
<p><span class="math display">\[ f(x) = \frac{x^{a-1} (1-x)^{b-1}}{B(a,b)}, \]</span></p>
<p>where <span class="math inline">\(a,b &gt; 0\)</span>, <span class="math inline">\(0 \leq x \leq 1\)</span>, and <span class="math inline">\(B(a,b)\)</span> is the beta function (normalising constant). The density curve takes different shapes as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="right"><span class="math inline">\(a\)</span></th>
<th align="right"><span class="math inline">\(b\)</span></th>
<th align="left">Shape</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(&lt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&lt; 1\)</span></td>
<td align="left">
<span class="math inline">\(U\)</span>-shaped</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(1\)</span></td>
<td align="right"><span class="math inline">\(~~~1\)</span></td>
<td align="left">Uniform</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(2\)</span></td>
<td align="right"><span class="math inline">\(~~~1\)</span></td>
<td align="left">Triangular (positive)</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(1\)</span></td>
<td align="right"><span class="math inline">\(~~~2\)</span></td>
<td align="left">Triangular (negative)</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(&gt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&lt; 1\)</span></td>
<td align="left">
<span class="math inline">\(J\)</span>-shaped (positive)</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(&lt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&gt; 1\)</span></td>
<td align="left">
<span class="math inline">\(J\)</span>-shaped (negative)</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(&gt; 1\)</span></td>
<td align="right"><span class="math inline">\(~~~&gt; 1\)</span></td>
<td align="left">Unimodal</td>
</tr>
</tbody>
</table>
<p>We modify this by translating the <span class="math inline">\(x\)</span>-domain from <span class="math inline">\((0,1)\)</span> to <span class="math inline">\((c,d)\)</span>, and multiplying by a height parameter <span class="math inline">\(H\)</span>. We also transform the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters to the <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> as follows:</p>
<p><span class="math display">\[ u = \frac{a}{a+b}, ~~~v=\frac{1}{a+b}. \]</span></p>
<p>Under this parameterisation, <span class="math inline">\(u\)</span> (<span class="math inline">\(0&lt;u&lt;1\)</span>) is the mean of the beta distribution, and <span class="math inline">\(v\)</span> (<span class="math inline">\(v&gt;0\)</span>) is a shape parameter. We restrict ourselves to functions that are not <span class="math inline">\(U\)</span> or <span class="math inline">\(J\)</span> shaped (i.e <span class="math inline">\(a \geq 1\)</span>, and <span class="math inline">\(b \geq 1\)</span>).</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, c, d, u, v\} \\
H &amp;= \mbox{Mean response} ~(H &gt; 0 ~~\mbox{or}~~ 0 &lt; H &lt; 1 ~~\mbox{or}~~ 0 &lt; H &lt; n) \\
c &amp;= \mbox{Lower bound} ~(-\infty &lt; c &lt; \infty)  \\
d &amp;= \mbox{Upper bound} ~(-\infty &lt; d &lt; \infty, ~c &lt; d)  \\
u &amp;= \mbox{Mean of the beta distribution} ~(0 &lt; u &lt; 1) \\
v &amp;= \mbox{Shape parameter} ~(v &gt; 0)
~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}\frac{1}{B(a,b)}
\left(\frac{x-c}{d-c}\right)^{a-1}
\left(\frac{d-x}{d-c}\right)^{b-1}
\end{aligned}
\]</span> where <span class="math inline">\(a=\frac{u}{v}\)</span> and <span class="math inline">\(b=\frac{1-u}{v}\)</span>, and <span class="math inline">\(H_m\)</span> is the maximum value of the beta distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"beta"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"c"</span> <span class="st">"d"</span> <span class="st">"u"</span> <span class="st">"v"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sech-main">
<tt>sech</tt> (main)<a class="anchor" aria-label="anchor" href="#sech-main"></a>
</h4>
<p>This mean function is a modified sech function. The basic sech function has the following form:</p>
<p><span class="math display">\[ \mbox{sech} (x) = \frac{2}{e^x + e^{-x}}. \]</span></p>
<p>This is a symmetric, unimodal function centered around zero. This function is modified as follows.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, s, r, p\} \\
H &amp;= \mbox{Mean response} ~(H &gt; 0 ~~\mbox{or}~~ 0 &lt; H &lt; 1 ~~\mbox{or}~~ 0 &lt; H &lt; n) \\
m &amp;= \mbox{Mode} ~(-\infty &lt; m &lt; \infty)  \\
s &amp;= \mbox{Spread parameter} ~(s &gt; \infty)  \\
r &amp;= \mbox{Skewness parameter} ~(-1 &lt; r &lt; 1) \\
p &amp;= \mbox{Peakedness parameter} ~(p &gt; 0)
~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\exp\left(\frac{rp}{s}(x - (m-x_m))\right)
\left(\mbox{sech}\left(\frac{x-(m-x_m)}{s}\right)\right)^p
\end{aligned}
\]</span> where <span class="math inline">\(x_m = \frac{s}{2}\log\left(\frac{1+r}{1-r}\right)\)</span> and <span class="math inline">\(H_m = \exp\left(\frac{rp}{s}x_m\right)\left(\sqrt{1 - r^2}\right)^p\)</span> The values <span class="math inline">\(x_m\)</span> and <span class="math inline">\(H_m\)</span> are used to fix the curve so <span class="math inline">\(m\)</span> is the location of the mode, and <span class="math inline">\(H\)</span> is the maximum height of the curve (at <span class="math inline">\(m\)</span>). If <span class="math inline">\(r\)</span> is positive the curve is positively skewed.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"sech"</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span> <span class="st">"r"</span> <span class="st">"p"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sech-p1-sub">
<tt>sech.p1</tt> (sub)<a class="anchor" aria-label="anchor" href="#sech-p1-sub"></a>
</h4>
<p>This is the same mean function as <tt>sech</tt> but with <span class="math inline">\(p = 1\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"sech.p1"</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span> <span class="st">"r"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sech-r0p1-sub">
<tt>sech.r0p1</tt> (sub)<a class="anchor" aria-label="anchor" href="#sech-r0p1-sub"></a>
</h4>
<p>This is the same mean function as <tt>sech</tt> but with <span class="math inline">\(r = 0\)</span>, and <span class="math inline">\(p = 1\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"sech.r0p1"</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gaussian-main">
<tt>gaussian</tt> (main)<a class="anchor" aria-label="anchor" href="#gaussian-main"></a>
</h4>
<p>This mean function is a Gaussian curve with a maximum height <span class="math inline">\(H\)</span>, located at mean/mode <span class="math inline">\(m\)</span>, and a standard deviation of <span class="math inline">\(s\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M  &amp;= \{H, m, s\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
m &amp;= \mbox{Location of maximum of mean function} 
          ~(-\infty &lt; m &lt; \infty)  \\
s &amp;= \mbox{Standard deviation of mean function} ~(s &gt; 0) \\
~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= H \exp\left(-\frac{1}{2}\left(\frac{x-m}{s}\right)^2\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"gaussian"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"s"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="mixgaussian-main">
<tt>mixgaussian</tt> (main)<a class="anchor" aria-label="anchor" href="#mixgaussian-main"></a>
</h4>
<p>This mean function is a mixture of two Gaussian curves. The first component has a maximum height located at mean/mode <span class="math inline">\(m_1\)</span>, with a standard deviation of <span class="math inline">\(s_1\)</span>. Similarly the second component has a maximum height located at mean/mode <span class="math inline">\(m_2\)</span>, with a standard deviation of <span class="math inline">\(s_2\)</span>. The mixture probability is given by <span class="math inline">\(\alpha\)</span>, and the maximum height of the curve is given by <span class="math inline">\(H\)</span>. The condition, <span class="math inline">\(m_1 \leq m_2\)</span>, ensures that component one is always on the left.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, \alpha, m_1, m_2, s_1, s_2\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
\alpha &amp;= \mbox{Mixture probability for first component} ~(0 &lt; \alpha &lt; 1) \\
  m_i &amp;= \mbox{Mean/mode of $i^{th}$ component}
  ~(-\infty &lt; m_i&lt; \infty) \\
  s_i &amp;= \mbox{Standard deviation of $i^{th}$ component} 
   ~(s_i &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}\left\{ \alpha\exp\left(-\frac{1}{2}\left(\frac{x-m_1}{s_1}\right)^2\right) + 
              (1-\alpha)\exp\left(-\frac{1}{2}\left(\frac{x-m_2}{s_2}\right)^2\right)
              \right\}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(H_m\)</span> is the maximum value of the unscaled (<span class="math inline">\(H=1\)</span>) gaussian mixture curve. This is determined numerically.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"mixgaussian"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"a"</span>  <span class="st">"m1"</span> <span class="st">"m2"</span> <span class="st">"s1"</span> <span class="st">"s2"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="mixgaussian-equal-sub">
<tt>mixgaussian.equal</tt> (sub)<a class="anchor" aria-label="anchor" href="#mixgaussian-equal-sub"></a>
</h4>
<p>This mean function is a the same as the <tt>mixgaussian</tt> mean function, but with the constraint that <span class="math inline">\(s_1 = s_2 ~(=s)\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"mixgaussian.equal"</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"a"</span>  <span class="st">"m1"</span> <span class="st">"m2"</span> <span class="st">"s"</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hofv-main">
<tt>hofV</tt> (main)<a class="anchor" aria-label="anchor" href="#hofv-main"></a>
</h4>
<p>This mean function is a scaled product of two sigmoid (logistic) growth curves (one increasing and one decreasing). The growth rates of each curve are <span class="math inline">\(\omega_1\)</span> and <span class="math inline">\(\omega_2\)</span> , and the points of inflection (half height locations) of each curve occur at <span class="math inline">\(m − k\)</span> and <span class="math inline">\(m + k\)</span> respectively.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega_1, \omega_2, k\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Mid-point between points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega_1 &amp;= \mbox{Growth rate parameter of increasing growth curve}
  ~(\omega_1 &gt; 0) \\
  \omega_2 &amp;= \mbox{Growth rate parameter of decreasing growth curve} 
  ~(\omega_2 &gt; 0) \\
  k &amp;= \mbox{Half the distance between points of inflections} ~(k &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\left(\frac{1}{1 + \exp{(-\omega_1(x-(m-k))}}\right)
\left(\frac{1}{1 + \exp{(\omega_2(x-(m+k))}}\right)
\end{aligned}
\]</span></p>
<p>The variable <span class="math inline">\(H_m\)</span> is the maximum value of the unscaled product of the sigmoidal functions. The value of <span class="math inline">\(H_m\)</span> is determined numerically.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofV"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"m"</span>  <span class="st">"w1"</span> <span class="st">"w2"</span> <span class="st">"k"</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hofii-sub">
<tt>hofII</tt> (sub)<a class="anchor" aria-label="anchor" href="#hofii-sub"></a>
</h4>
<p>This mean function is a sigmoid (logistic) growth curve with a maximum height of <span class="math inline">\(H\)</span>, a point of inflection <span class="math inline">\(m\)</span>, and a growth rate parameter of <span class="math inline">\(\omega_0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega_0\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Point of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega_0 &amp;= \mbox{Growth rate parameter} ~(-\infty &lt; \omega_0 &lt; \infty) 
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= H\left(\frac{1}{1 + \exp{(-\omega_0(x-m))}}\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofII"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"m"</span>  <span class="st">"w0"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hofiv-sub">
<tt>hofIV</tt> (sub)<a class="anchor" aria-label="anchor" href="#hofiv-sub"></a>
</h4>
<p>This mean function is a scaled product of two sigmoid (logistic) growth curves (one increasing and one decreasing). The growth rates of each curve is <span class="math inline">\(\omega\)</span>, and points of inflection (half height locations) of each curve occur at <span class="math inline">\(m − k\)</span> and <span class="math inline">\(m + k\)</span> respectively.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega, k\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Mid-point between points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega &amp;= \mbox{Growth rate parameter} ~(\omega &gt; 0) \\
  k &amp;= \mbox{Half the distance between points of inflections} ~(k &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\left(\frac{1}{1 + \exp{(-\omega(x-(m-k))}}\right)
\left(\frac{1}{1 + \exp{(\omega(x-(m+k))}}\right)
\end{aligned}
\]</span></p>
<p>The variable <span class="math inline">\(H_m\)</span> is the maximum value of the unscaled product of the sigmoidal functions. <span class="math inline">\(H_m = (1 + \exp(−\omega k))^{−2}\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofIV"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"w"</span> <span class="st">"k"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hofivb-sub">
<tt>hofIVb</tt> (sub)<a class="anchor" aria-label="anchor" href="#hofivb-sub"></a>
</h4>
<p>This is the same mean function as the <tt>hofIV</tt>, except that <span class="math inline">\(k = 0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Location of points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega &amp;= \mbox{Growth rate parameter} ~(\omega &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{0.25}
\left(\frac{1}{1 + \exp{(-\omega(x-m)}}\right)
\left(\frac{1}{1 + \exp{(\omega(x-m)}}\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofIVb"</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span> <span class="st">"m"</span> <span class="st">"w"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="hofvb-sub">
<tt>hofVb</tt> (sub)<a class="anchor" aria-label="anchor" href="#hofvb-sub"></a>
</h4>
<p>This is the same mean function as the <tt>hofV</tt>, except that <span class="math inline">\(k = 0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\theta_M &amp;= \{H, m, \omega_1, \omega_2\} \\
H &amp;= \mbox{Maximum value of mean function} ~(H &gt; 0, ~~\mbox{or}~~ 0 &lt; H &lt; 1, ~~\mbox{or}~~ 0 &lt; H &lt; n)  \\
  m &amp;= \mbox{Mid-point between points of inflection} ~(-\infty &lt; m &lt; \infty) \\
  \omega_1 &amp;= \mbox{Growth rate parameter of increasing growth curve}
  ~(\omega_1 &gt; 0) \\
  \omega_2 &amp;= \mbox{Growth rate parameter of decreasing growth curve} 
  ~(\omega_2 &gt; 0) \\
  ~ &amp; ~ \\
\mu_{\theta_M}(x) &amp;= \frac{H}{H_m}
\left(\frac{1}{1 + \exp{(-\omega_1(x-m)}}\right)
\left(\frac{1}{1 + \exp{(\omega_2(x-m)}}\right)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">get_mean_fun_parnames</span>(<span class="st">"hofVb"</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>[<span class="dv">1</span>] <span class="st">"H"</span>  <span class="st">"m"</span>  <span class="st">"w1"</span> <span class="st">"w2"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="error-disributions">Error disributions<a class="anchor" aria-label="anchor" href="#error-disributions"></a>
</h3>
<p>The error distributions are described in this section. Each error distribution is classified as to the type of data it is suited for. This information is shown in the table below.</p>
<table class="table">
<thead><tr class="header">
<th align="left">err_dist</th>
<th align="left">err_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">bernoulli</td>
<td align="left">binary</td>
</tr>
<tr class="even">
<td align="left">binomial.count</td>
<td align="left">binomial</td>
</tr>
<tr class="odd">
<td align="left">binomial.prop</td>
<td align="left">binomial</td>
</tr>
<tr class="even">
<td align="left">poisson</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">negbin</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">zip</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">zinb</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">zipl</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">zinbl</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">zipl.mu</td>
<td align="left">count</td>
</tr>
<tr class="odd">
<td align="left">zinbl.mu</td>
<td align="left">count</td>
</tr>
<tr class="even">
<td align="left">gaussian</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">tweedie</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">zig</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">zigl</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">zigl.mu</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">ziig</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">ziigl</td>
<td align="left">abundance</td>
</tr>
<tr class="odd">
<td align="left">ziigl.mu</td>
<td align="left">abundance</td>
</tr>
<tr class="even">
<td align="left">tab</td>
<td align="left">percentage</td>
</tr>
<tr class="odd">
<td align="left">zitab</td>
<td align="left">percentage</td>
</tr>
</tbody>
</table>
<p>In the sections that follow, the value of mean function at the <span class="math inline">\(i^{th}\)</span> observation <span class="math inline">\(x_i\)</span>, is denoted by <span class="math inline">\(\mu_i\)</span>. In other words:</p>
<p><span class="math display">\[ \mu_i = \mu_{\theta_M} (x_i). \]</span></p>
<div class="section level4">
<h4 id="bernoulli-binary">
<tt>bernoulli</tt> (binary)<a class="anchor" aria-label="anchor" href="#bernoulli-binary"></a>
</h4>
<p>The Bernouli distribution is used for modelling binary data (<span class="math inline">\(0/1\)</span>). The mean function is bounded between 0 and 1. There are no extra parameters for this distribution.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1\} \\
\theta_E &amp;= \{\} \\
P (Y_i = y_i \mid \theta_M, ~\theta_E , ~x_i) 
&amp;\sim \mbox{Bernoulli}(\mu_i) \\
\end{aligned}
\]</span></p>
</div>
<div class="section level4">
<h4 id="binomial-count-binomial">
<tt>binomial.count</tt> (binomial)<a class="anchor" aria-label="anchor" href="#binomial-count-binomial"></a>
</h4>
<p>The binomial distribution is used for modelling count data that is bounded between 0 and <span class="math inline">\(n\)</span>. The mean function is bounded between 0 and <span class="math inline">\(n\)</span>. There are no extra parameters for this distribution.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, \ldots, n\} \\
\theta_E &amp;= \{\} \\
\theta_C &amp;= \{n\} \\
P (Y_i = y_i \mid ~\theta_M , ~\theta_C , ~x_i) 
&amp;\sim \mbox{Binomial}(n, ~\mu_i) \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">get_constant_parnames</span>(<span class="st">"binomial.count"</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>[<span class="dv">1</span>] <span class="st">"binomial_n"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="binomial-prop-binomial">
<tt>binomial.prop</tt> (binomial)<a class="anchor" aria-label="anchor" href="#binomial-prop-binomial"></a>
</h4>
<p>This is that same model as the <tt>binomial.count</tt> distribution, except the data recorded as proportions (counts divided by <span class="math inline">\(n\)</span>).</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{\frac{0}{n}, \frac{1}{n}, \ldots, \frac{n}{n}\} \\
\theta_E &amp;= \{\} \\
\theta_C &amp;= \{n\} \\
P (Y_i = ny_i \mid ~\theta_M , ~\theta_C , ~x_i) 
&amp;\sim \mbox{Binomial}(n, ~\mu_i) \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">get_constant_parnames</span>(<span class="st">"binomial.prop"</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>[<span class="dv">1</span>] <span class="st">"binomial_n"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="poisson-count">
<tt>poisson</tt> (count)<a class="anchor" aria-label="anchor" href="#poisson-count"></a>
</h4>
<p>The Poisson distribution has mean parameter <span class="math inline">\(\lambda=\mu_{\theta_M} (x))\)</span>. There are no extra parameters for this distribution.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\} \\
P (Y_i = y_i \mid \theta_M , ~\theta_E , ~x_i) 
&amp;\sim \mbox{Poisson}(\lambda_i=\mu_i) \\
\end{aligned}
\]</span></p>
</div>
<div class="section level4">
<h4 id="negbin-count">
<tt>negbin</tt> (count)<a class="anchor" aria-label="anchor" href="#negbin-count"></a>
</h4>
<p>The negative-binomial distribution we use is actually a Gamma-Poisson distribution with the following form:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\lambda_i &amp;\sim \mbox{Gamma}(\mbox{shape}=\alpha, ~\mbox{rate}=\beta_i),\\
  P(Y_i=y_i \mid \lambda_i) &amp;\sim \mbox{Poisson}(\lambda_i) \\
  ~ &amp; ~ \\
\mbox{E}(\lambda_i) &amp;= \frac{\alpha}{\beta_i} \\
\mbox{var}(\lambda_i) &amp;= \frac{\alpha}{\beta_i^2}, \\
\mbox{E}(Y_i) &amp;= \frac{\alpha}{\beta_i} + \frac{\alpha}{\beta_i^2} = \mu_i \\
\mbox{var}(Y_i) &amp;= \frac{\alpha}{\beta_i^2} = \mu_i + \frac{\mu_i^2}{\alpha} = \mu_i + \phi \mu_i^2 \\
\end{aligned}
\]</span> where <span class="math inline">\(\phi = \dfrac{1}{\alpha}\)</span> is the dispersion parameter (<span class="math inline">\(\phi=0\)</span> corresponds to a Poisson distribution), and <span class="math inline">\(\mu_i\)</span> is the mean parameter.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
  \theta_E  &amp;= \{\phi\} \\
  \phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
  P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{Gamma-Poisson}(\mu_i, ~\phi)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"negbin"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>[<span class="dv">1</span>] <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zip-count">
<tt>zip</tt> (count)<a class="anchor" aria-label="anchor" href="#zip-count"></a>
</h4>
<p>The zero-inflated Poisson (ZIP) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E  &amp;= \{\pi\} \\
\pi &amp;= \mbox{Zero-spike parameter}, (0 \leq \pi \leq 1) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
  &amp;\sim \mbox{ZIP}(\mu_i, ~\pi) \\
  &amp;\sim \left\{\begin{array}{ll}
                 \mbox{Poisson}(\mu_i),
                 &amp; \mbox{w.p.} ~~1-\pi, \\
                 0, &amp; \mbox{w.p.} ~~\pi.
               \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zip"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zinb-count">
<tt>zinb</tt> (count)<a class="anchor" aria-label="anchor" href="#zinb-count"></a>
</h4>
<p>The zero-inflated negative-binomial (ZINB) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\pi, \phi\} \\
\pi &amp;= \mbox{Zero-spike parameter} ~(0 \leq \pi \leq 1) \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZINB}(\mu_i, ~\pi, ~\phi) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Gamma-Poisson}(\mu_i, ~\phi),
            &amp; \mbox{w.p.} ~~1-\pi, \\
            0, &amp; \mbox{w.p.} ~~\pi.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zinb"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zipl-count">
<tt>zipl</tt> (count)<a class="anchor" aria-label="anchor" href="#zipl-count"></a>
</h4>
<p>The zero-inflated Poisson linked (ZIPL) distribution is a Poisson distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, with a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZIPL}(\mu_i, ~\gamma_0, ~\gamma_1) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Poisson}(\mu_i),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zipl"</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span> <span class="st">"g1"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zinbl-count">
<tt>zinbl</tt> (count)<a class="anchor" aria-label="anchor" href="#zinbl-count"></a>
</h4>
<p>The zero-inflated negative-binomial linked (ZINBL) distribution is a negative-binomial distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and has zero-spike parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1, \phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZINBL}(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Gamma-Poisson}(\mu_i, ~\phi),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zinbl"</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zipl-mu-count">
<tt>zipl.mu</tt> (count)<a class="anchor" aria-label="anchor" href="#zipl-mu-count"></a>
</h4>
<p>The zero-inflated Poisson linked-<span class="math inline">\(\mu\)</span> (ZIPL<span class="math inline">\(-\mu\)</span>) distribution is a Poisson distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, with a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZIPL-}\mu(\mu_i, ~\gamma_0, ~\gamma_1) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Poisson}(\mu_i),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zipl.mu"</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span> <span class="st">"g1"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zinbl-mu-count">
<tt>zinbl.mu</tt> (count)<a class="anchor" aria-label="anchor" href="#zinbl-mu-count"></a>
</h4>
<p>The zero-inflated negative-binomial linked-<span class="math inline">\(\mu\)</span> (ZINBL-<span class="math inline">\(\mu\)</span>) distribution is a negative-binomial distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and has zero-spike parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in \{0, 1, 2, \ldots \} \\
\theta_E &amp;= \{\gamma_0, \gamma_1, \phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
            &amp;\sim \mbox{ZINB-}\mu(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
            &amp;\sim \left\{\begin{array}{ll}
            \mbox{Gamma-Poisson}(\mu_i, ~\phi),
            &amp; \mbox{w.p.} ~~1-\pi_i, \\
            0, &amp; \mbox{w.p.} ~~\pi_i.
           \end{array}\right.
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zinbl.mu"</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gaussian-abundance">
<tt>gaussian</tt> (abundance)<a class="anchor" aria-label="anchor" href="#gaussian-abundance"></a>
</h4>
<p>The Gaussian distribution has mean parameter <span class="math inline">\(\mu_i\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\sigma\} \\
\sigma &amp;= \mbox{Standard deviation} ~(\sigma &gt; 0) \\
P(Y_i=y_i \mid ~\theta_M, ~\theta_E, ~x_i) 
        &amp;\sim \mbox{Normal}(\mu_i, ~\sigma^2)
\end{aligned}
\]</span> Since our data is non-negative, any data simulated via this model will have negative values set to zero.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"gaussian"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>[<span class="dv">1</span>] <span class="st">"sigma"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tweedie-abundance">
<tt>tweedie</tt> (abundance)<a class="anchor" aria-label="anchor" href="#tweedie-abundance"></a>
</h4>
<p>Tweedie distributions are a class of exponential dispersion models where the variance is a function of the mean of the form:</p>
<p><span class="math display">\[ \mbox{var}(Y_i) = \phi\mu_i^\rho,\]</span></p>
<p>where <span class="math inline">\(\rho \in (-\infty, 0] \cup [1, \infty)\)</span>. Special cases include the normal (<span class="math inline">\(\rho = 0\)</span>), Poisson (<span class="math inline">\(\rho = 1\)</span>), Gamma (<span class="math inline">\(\rho = 2\)</span>) and inverse Gaussian (<span class="math inline">\(\rho = 3\)</span>) distributions. For <span class="math inline">\(1 &lt; \rho &lt; 2\)</span>, the distributions are continuous for <span class="math inline">\(Y &gt; 0\)</span> and have a discrete mass at <span class="math inline">\(Y = 0\)</span>. We will restrict our attention to <span class="math inline">\(1 &lt; \rho &lt; 2\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\phi, ~\rho\} \\
\phi &amp;= \mbox{Dispersion parameter} ~(\phi &gt; 0) \\
\rho &amp;= \mbox{Power parameter} ~(1 &lt; \rho &lt; 2) \\
P(Y_i=y_i \mid ~\theta_M, ~\theta_E, ~x_i) 
        &amp;\sim \mbox{Tweedie}(\mu_i, ~\phi, ~\rho) \\
\mbox{E}(Y_i) &amp;= \mu_i \\
\mbox{var}(Y_i) &amp;= \phi(\mu_i)^\rho 
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"tweedie"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>[<span class="dv">1</span>] <span class="st">"phi"</span> <span class="st">"rho"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zig-abundance">
<tt>zig</tt> (abundance)<a class="anchor" aria-label="anchor" href="#zig-abundance"></a>
</h4>
<p>The zero-inflated Gamma (ZIG) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\pi, ~\phi\} \\
\pi &amp;= \mbox{Zero-spike parameter}, ~(0 \leq \pi \leq 1) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIG}(\mu_i, ~\pi, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi, \\
  0, &amp; \mbox{w.p.} ~~\pi.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^2
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zig"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zigl-abundance">
<tt>zigl</tt> (abundance)<a class="anchor" aria-label="anchor" href="#zigl-abundance"></a>
</h4>
<p>The zero-inflated gamma linked (ZIGL) distribution is a Gamma distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIGL}(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^2
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zigl"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zigl-mu-abundance">
<tt>zigl.mu</tt> (abundance)<a class="anchor" aria-label="anchor" href="#zigl-mu-abundance"></a>
</h4>
<p>The zero-inflated gamma linked-<span class="math inline">\(\mu\)</span> (ZIGL-<span class="math inline">\(\mu\)</span>) distribution is a Gamma distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIGL-}\mu(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^2
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zigl.mu"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ziig-abundance">
<tt>ziig</tt> (abundance)<a class="anchor" aria-label="anchor" href="#ziig-abundance"></a>
</h4>
<p>The zero-inflated inverse-Gaussian (ZIIG) distribution has zero-spike parameter <span class="math inline">\(\pi\)</span>, dispersion parameter <span class="math inline">\(\phi\)</span>, and mean parameter <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\pi, ~\phi\} \\
\pi &amp;= \mbox{Zero-spike parameter}, ~(0 \leq \pi \leq 1) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIIG}(\mu_i, ~\pi, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Inverse-Gaussian}(\mu_i, \phi)
  &amp; \mbox{w.p.} ~~1-\pi, \\
  0, &amp; \mbox{w.p.} ~~\pi.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1 - \pi)\mu_i^2 + (1-\pi)\phi\mu_i^3
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"ziig"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ziigl-abundance">
<tt>ziigl</tt> (abundance)<a class="anchor" aria-label="anchor" href="#ziigl-abundance"></a>
</h4>
<p>The zero-inflated inverse-Gaussian linked (ZIIGL) distribution is an inverse-Gaussian distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/log scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\log(\mu_i), \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIIGL}(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^3
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"ziigl"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ziigl-mu-abundance">
<tt>ziigl.mu</tt> (abundance)<a class="anchor" aria-label="anchor" href="#ziigl-mu-abundance"></a>
</h4>
<p>The zero-inflated inverse-Gaussian linked-<span class="math inline">\(\mu\)</span> (ZIIGL-<span class="math inline">\(\mu\)</span>) distribution is an inverse-Gaussian distribution with mean parameter <span class="math inline">\(\mu_i\)</span>, a dispersion parameter <span class="math inline">\(\phi\)</span>, and a zero spike that has parameters <span class="math inline">\(\gamma_0\)</span> and <span class="math inline">\(\gamma_1\)</span>. The zero-spike parameters are linked to the mean function on the logit/linear scale as follows:</p>
<p><span class="math display">\[ \mbox{logit}(\pi_i) = \gamma_0 + \gamma_1\mu_i, \]</span></p>
<p>where <span class="math inline">\(\pi_i\)</span> is the value of the zero-spike parameter at <span class="math inline">\(x_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\geq 0 \\
\theta_E  &amp;= \{\gamma_0, ~\gamma_1, ~\phi\} \\
\gamma_0 &amp;= \mbox{Zero-spike parameter intercept} 
~(-\infty \leq \gamma_0 \leq \infty) \\
\gamma_1 &amp;= \mbox{Zero-spike parameter slope} 
~(-\infty \leq \gamma_1 \leq \infty) \\
\phi &amp;= \mbox{Dispersion parameter}, ~(\phi &gt; 0) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~x_i) 
&amp;\sim \mbox{ZIIGL-}\mu(\mu_i, ~\gamma_0, ~\gamma_1, ~\phi) \\
&amp;\sim \left\{\begin{array}{ll}
  \mbox{Gamma}(\mbox{shape}=1/\phi, 
  ~\mbox{scale} = \phi\mu_i)
  &amp; \mbox{w.p.} ~~1-\pi_i, \\
  0, &amp; \mbox{w.p.} ~~\pi_i.
  \end{array}\right.\\
\mbox{E}(Y_i) &amp;= (1 - \pi)\mu_i \\
\mbox{var}(Y_i) &amp;= \pi(1-\pi)\mu^2 + (1-\pi)\phi\mu_i^3
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"ziigl.mu"</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>[<span class="dv">1</span>] <span class="st">"g0"</span>  <span class="st">"g1"</span>  <span class="st">"phi"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tab-percentage">
<tt>tab</tt> (percentage)<a class="anchor" aria-label="anchor" href="#tab-percentage"></a>
</h4>
<p>The tail-adjusted beta (TAB) distribution is a beta distribution where values less than <span class="math inline">\(\delta\)</span> are rounded down to zero, and values greater than <span class="math inline">\(1-\delta\)</span> are rounded up to one. This is used to model data that is between 0 and 1 (inclusive).</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in [0,1] \\
\theta_E &amp;= \{\sigma\} \\
\theta_C &amp;= \{\delta\} \\
\sigma &amp;= \mbox{Shape parameter}, (\sigma &gt; 0) \\
\delta &amp;= \mbox{Rounding parameter}, (0 &lt; \delta &lt; \frac{1}{2}) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~\theta_C, ~x_i) 
&amp;\sim \mbox{TAB}(\mu_i, ~\sigma, ~\delta) \\
&amp;\sim \left\{\begin{array}{ll}
\frac{p^{(0)}_i}{\delta} &amp; y_i &lt; \delta \\
\dfrac{y_i^{\alpha_i-1}(1-y_i)^{\beta-1}}{B(\alpha,\beta)}
&amp; \delta &lt; y_i &lt; 1 - \delta \\
\frac{p^{(1)}_i}{\delta} &amp; y_i &gt; 1 - \delta \\
\end{array}\right.\\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(p^{(0)}_i\)</span> is the probability the Beta(<span class="math inline">\(\alpha_i, ~\beta)\)</span> distribution is less than <span class="math inline">\(\delta\)</span>, and <span class="math inline">\(p^{(1)}_i\)</span> is the probability the Beta(<span class="math inline">\(\alpha_i, ~\beta)\)</span> distribution is greater than <span class="math inline">\(1 - \delta\)</span>. The parameters of the TAB (<span class="math inline">\(\mu_i\)</span>, <span class="math inline">\(\sigma\)</span>) are converted to beta distribution parameters (<span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta\)</span>) and back again as follows: <span class="math display">\[
\begin{aligned}
\mu_i &amp;= \dfrac{\alpha_i}{\alpha_i + \beta}, &amp;~
\sigma &amp;= \dfrac{1}{\alpha_i + \beta} \\
\alpha &amp; = \dfrac{\mu_i}{\sigma}, &amp;~ \beta &amp;= \dfrac{1 - \mu_i}{\sigma}
\end{aligned}
\]</span></p>
<p>We restrict ourselves to <span class="math inline">\(\alpha_i \geq 1\)</span> and <span class="math inline">\(\beta \geq 1\)</span> (uniform, triangular, and unimodal shapes).</p>
<p>The <span class="math inline">\(\delta\)</span> parameter is not estimated via maximum likelihood like other parameters, it is estimated as the minimum of: the smallest non-zero <span class="math inline">\(y_i\)</span>, and one minus the largest non-one <span class="math inline">\(y_i\)</span>. In other words:</p>
<p><span class="math display">\[ \hat{\delta} = \min( \min_i(y_i : y_i&gt;0), ~\min_i(1-y_i : y_i &lt; 1) ). \]</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"tab"</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>[<span class="dv">1</span>] <span class="st">"sigma"</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="kw">get_constant_parnames</span>(<span class="st">"tab"</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a>[<span class="dv">1</span>] <span class="st">"delta"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zitab-percentage">
<tt>zitab</tt> (percentage)<a class="anchor" aria-label="anchor" href="#zitab-percentage"></a>
</h4>
<p>The zero-inflated tail-adjusted Beta (ZITAB) distribution is the tail-adjusted beta distribution with a zero-inflated spike added.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\in [0,1] \\
\theta_E &amp;= \{\pi, ~\sigma\} \\
\theta_C &amp;= \{\delta\} \\
\pi &amp;= \mbox{Zero-spike parameter}, ~(0 \leq \pi \leq 1) \\
\sigma &amp;= \mbox{Shape parameter}, (\sigma &gt; 0) \\
\delta &amp;= \mbox{Rounding parameter}, (0 &lt; \delta &lt; \frac{1}{2}) \\
P(Y_i=y_i \mid \theta_M, ~\theta_E, ~\theta_C, ~x_i) 
            &amp;\sim \mbox{ZITAB}(\mu_i, ~\pi, ~\sigma, ~\delta) \\
            &amp;\sim \left\{\begin{array}{ll}
            \pi + (1-\pi)p^{(0)}_i &amp; y_i &lt; \delta \\
            (1-\pi)\dfrac{y_i^{\alpha_i-1}(1-y_i)^{\beta-1}}{B(\alpha,\beta)}
            &amp; \delta &lt; y_i &lt; 1 - \delta \\
            (1-\pi)p^{(1)}_i &amp; y_i &gt; 1 - \delta \\
            \end{array}\right.\\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">get_err_dist_parnames</span>(<span class="st">"zitab"</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a>[<span class="dv">1</span>] <span class="st">"pi"</span>    <span class="st">"sigma"</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">get_constant_parnames</span>(<span class="st">"zitab"</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a>[<span class="dv">1</span>] <span class="st">"delta"</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-models">Fitting models<a class="anchor" aria-label="anchor" href="#fitting-models"></a>
</h2>
<div class="section level3">
<h3 id="setting-models-to-fit">Setting models to fit<a class="anchor" aria-label="anchor" href="#setting-models-to-fit"></a>
</h3>
<p>The <tt>set_models()</tt> function is used to create a data frame that contains the mean functions, error distributions, and if appropriate the binomial <span class="math inline">\(n\)</span> parameter, of all models that one would wish to fit or simulate data from.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">## All possible combinations of mean functions and error distrbiutions</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="kw">c</span>(<span class="st">"gaussian"</span>, <span class="st">"beta"</span>), <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"zinb"</span>, <span class="st">"zinbl"</span>),</span>
<span id="cb36-3"><a href="#cb36-3"></a>            <span class="dt">method=</span><span class="st">"crossed"</span>)</span>
<span id="cb36-4"><a href="#cb36-4"></a>  mean_fun err_dist binomial_n</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="dv">1</span>     beta     zinb         <span class="ot">NA</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="dv">2</span>     beta    zinbl         <span class="ot">NA</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="dv">3</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="dv">4</span> gaussian    zinbl         <span class="ot">NA</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="co">## Fit specific models</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="kw">c</span>(<span class="st">"gaussian"</span>, <span class="st">"beta"</span>), <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"zinb"</span>, <span class="st">"zinbl"</span>),</span>
<span id="cb36-11"><a href="#cb36-11"></a>            <span class="dt">method=</span><span class="st">"paired"</span>)</span>
<span id="cb36-12"><a href="#cb36-12"></a>  mean_fun err_dist binomial_n</span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="dv">1</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="dv">2</span>     beta    zinbl         <span class="ot">NA</span></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="co">## Fit binomial model - with n=40</span></span>
<span id="cb36-16"><a href="#cb36-16"></a><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="kw">c</span>(<span class="st">"gaussian"</span>), </span>
<span id="cb36-17"><a href="#cb36-17"></a>            <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"poisson"</span>, <span class="st">"binomial.prop"</span>, <span class="st">"binomial.count"</span>),</span>
<span id="cb36-18"><a href="#cb36-18"></a>            <span class="dt">binomial_n=</span><span class="dv">40</span>, <span class="dt">method=</span><span class="st">"paired"</span>)</span>
<span id="cb36-19"><a href="#cb36-19"></a>  mean_fun       err_dist binomial_n</span>
<span id="cb36-20"><a href="#cb36-20"></a><span class="dv">1</span> gaussian        poisson         <span class="ot">NA</span></span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="dv">2</span> gaussian  binomial.prop         <span class="dv">40</span></span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="dv">3</span> gaussian binomial.count         <span class="dv">40</span></span>
<span id="cb36-23"><a href="#cb36-23"></a><span class="co">## Can also specify via mean and error class</span></span>
<span id="cb36-24"><a href="#cb36-24"></a><span class="kw">set_models</span> (<span class="dt">mean_class=</span><span class="st">"main"</span>, <span class="dt">err_class=</span><span class="st">"percentage"</span>)</span>
<span id="cb36-25"><a href="#cb36-25"></a>      mean_fun err_dist binomial_n</span>
<span id="cb36-26"><a href="#cb36-26"></a><span class="dv">1</span>         beta      tab         <span class="ot">NA</span></span>
<span id="cb36-27"><a href="#cb36-27"></a><span class="dv">2</span>         beta    zitab         <span class="ot">NA</span></span>
<span id="cb36-28"><a href="#cb36-28"></a><span class="dv">3</span>     gaussian      tab         <span class="ot">NA</span></span>
<span id="cb36-29"><a href="#cb36-29"></a><span class="dv">4</span>     gaussian    zitab         <span class="ot">NA</span></span>
<span id="cb36-30"><a href="#cb36-30"></a><span class="dv">5</span>         hofV      tab         <span class="ot">NA</span></span>
<span id="cb36-31"><a href="#cb36-31"></a><span class="dv">6</span>         hofV    zitab         <span class="ot">NA</span></span>
<span id="cb36-32"><a href="#cb36-32"></a><span class="dv">7</span>  mixgaussian      tab         <span class="ot">NA</span></span>
<span id="cb36-33"><a href="#cb36-33"></a><span class="dv">8</span>  mixgaussian    zitab         <span class="ot">NA</span></span>
<span id="cb36-34"><a href="#cb36-34"></a><span class="dv">9</span>         sech      tab         <span class="ot">NA</span></span>
<span id="cb36-35"><a href="#cb36-35"></a><span class="dv">10</span>        sech    zitab         <span class="ot">NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulated-data">Simulated data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h3>
<p>This section describes how to simulate data sets for any possible model. The <tt>create_default_par_list()</tt> function set default parameter values for each selected model.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## --- Set models</span>
<span class="va">Models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_models.html">set_models</a></span> <span class="op">(</span>mean_fun<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span><span class="op">)</span>, err_dist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zip"</span>, <span class="st">"zinb"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## --- Set default parameters list</span>
<span class="va">Pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_default_par_list.html">create_default_par_list</a></span> <span class="op">(</span><span class="va">Models</span><span class="op">)</span>

<span class="co">## --- Simulate data</span>
<span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_simulated_datasets.html">create_simulated_datasets</a></span> <span class="op">(</span><span class="va">Pars</span>, N<span class="op">=</span><span class="fl">200</span>, xmin<span class="op">=</span><span class="fl">0</span>, xmax<span class="op">=</span><span class="fl">100</span>, seed<span class="op">=</span><span class="fl">12345</span><span class="op">)</span></code></pre></div>
<p>This code creates simulates data for the <tt>gaussian-zip</tt>, and <tt>gaussian-zinb</tt> models. The objects <tt>Pars</tt> is a list containing parameters for each model. The object <tt>Data</tt> is a list containing the data for each model; <tt>Data[[1]]</tt> is the data for the first model, etc.</p>
</div>
<div class="section level3">
<h3 id="real-data">Real data<a class="anchor" aria-label="anchor" href="#real-data"></a>
</h3>
<p>The <tt>senlm</tt> packages contains the following data sets:</p>
<ul>
<li><tt>haul</tt></li>
</ul>
<p>The first few rows of data are shown below.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">data</span>(haul, <span class="dt">package=</span><span class="st">"senlm"</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">head</span> (haul)</span>
<span id="cb38-3"><a href="#cb38-3"></a>     year    depth lattitude Albatrossia.pectoralis Sebastolobus.altivelis</span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="dv">1717</span> <span class="dv">2003</span> <span class="fl">527.5357</span>  <span class="fl">46.30425</span>                      <span class="dv">0</span>                     <span class="dv">37</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="dv">1718</span> <span class="dv">2003</span> <span class="fl">673.7497</span>  <span class="fl">46.73217</span>                      <span class="dv">0</span>                    <span class="dv">397</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="dv">1719</span> <span class="dv">2003</span> <span class="fl">276.1650</span>  <span class="fl">46.71926</span>                      <span class="dv">0</span>                      <span class="dv">0</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="dv">1720</span> <span class="dv">2003</span> <span class="fl">823.6656</span>  <span class="fl">46.92419</span>                      <span class="dv">3</span>                    <span class="dv">711</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="dv">1721</span> <span class="dv">2003</span> <span class="fl">172.6837</span>  <span class="fl">47.01439</span>                      <span class="dv">0</span>                      <span class="dv">0</span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="dv">1722</span> <span class="dv">2003</span> <span class="fl">985.7053</span>  <span class="fl">47.56385</span>                     <span class="dv">18</span>                    <span class="dv">534</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fitting-models-to-data">Fitting models to data<a class="anchor" aria-label="anchor" href="#fitting-models-to-data"></a>
</h3>
<p>To fit one model to a data set we use the <tt>senlm()</tt> function. We illustrate this with the <tt>haul</tt> dataset.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>Fit &lt;-<span class="st"> </span><span class="kw">senlm</span> (<span class="dt">data=</span>haul, <span class="dt">xvar=</span><span class="st">"depth"</span>, <span class="dt">yvar=</span><span class="st">"Sebastolobus.altivelis"</span>, </span>
<span id="cb39-2"><a href="#cb39-2"></a>              <span class="dt">mean_fun=</span><span class="st">"gaussian"</span>, <span class="dt">err_dist=</span><span class="st">"zip"</span>, <span class="dt">conf.level=</span><span class="fl">0.95</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="kw">summary</span> (Fit)</span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="op">$</span>model</span>
<span id="cb39-5"><a href="#cb39-5"></a>[<span class="dv">1</span>] <span class="st">"gaussian_zip"</span></span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="op">$</span>theta</span>
<span id="cb39-8"><a href="#cb39-8"></a>          H           m           s          pi </span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="fl">817.5307337</span> <span class="fl">917.8020572</span> <span class="fl">225.5627469</span>   <span class="fl">0.5954249</span> </span>
<span id="cb39-10"><a href="#cb39-10"></a></span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="op">$</span>IC</span>
<span id="cb39-12"><a href="#cb39-12"></a>    npar      nll      AIC     AICc      BIC </span>
<span id="cb39-13"><a href="#cb39-13"></a>    <span class="fl">4.00</span> <span class="fl">36950.05</span> <span class="fl">73908.10</span> <span class="fl">73908.14</span> <span class="fl">73928.01</span> </span></code></pre></div>
<p>Confidence intervals for the estimated parameters can be display as follows. The default confidence level is 95% which is set when fitting the model. Occasionly due to numerical instability of the estimated Hessian matrix the standard errors are not calculated.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">rbind</span> (<span class="dt">lower=</span>Fit<span class="op">$</span>lb, <span class="dt">upper=</span>Fit<span class="op">$</span>ub)</span>
<span id="cb40-2"><a href="#cb40-2"></a>             H        m        s        pi</span>
<span id="cb40-3"><a href="#cb40-3"></a>lower <span class="fl">812.7322</span> <span class="fl">916.2962</span> <span class="fl">224.2579</span> <span class="fl">0.5615004</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>upper <span class="fl">822.3576</span> <span class="fl">919.3079</span> <span class="fl">226.8752</span> <span class="fl">0.6284615</span></span></code></pre></div>
<p>To fit multiple models to multiple data sets, one can use the <tt>msenlm()</tt> function. The models to fit are specified with the <tt>set_models()</tt> function. The data should be stored in a list. It could be simulated data create using the <tt>create_simulated_datasets()</tt> function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>Models &lt;-<span class="st"> </span><span class="kw">set_models</span> (<span class="dt">mean_class=</span><span class="st">"test"</span>, <span class="dt">err_class=</span><span class="st">"binary"</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a>Pars   &lt;-<span class="st"> </span><span class="kw">create_default_par_list</span> (<span class="dt">models=</span>Models)</span>
<span id="cb41-3"><a href="#cb41-3"></a>Data   &lt;-<span class="st"> </span><span class="kw">create_simulated_datasets</span> (Pars, <span class="dt">seed=</span><span class="dv">12345</span>)</span>
<span id="cb41-4"><a href="#cb41-4"></a>Fits   &lt;-<span class="st"> </span><span class="kw">msenlm</span> (<span class="dt">models=</span>Models, <span class="dt">data=</span>Data, <span class="dt">xvar=</span><span class="st">"x"</span>, <span class="dt">yvar=</span><span class="kw">names</span>(Data)[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb41-5"><a href="#cb41-5"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="dv">1</span> constant bernoulli         <span class="ot">NA</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="dv">2</span>  uniform bernoulli         <span class="ot">NA</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="dv">1</span> constant bernoulli         <span class="ot">NA</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="dv">2</span>  uniform bernoulli         <span class="ot">NA</span></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="kw">print</span> (Models)</span>
<span id="cb41-14"><a href="#cb41-14"></a>  mean_fun  err_dist binomial_n</span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="dv">1</span> constant bernoulli         <span class="ot">NA</span></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="dv">2</span>  uniform bernoulli         <span class="ot">NA</span></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="kw">summary</span> (Fits)</span>
<span id="cb41-18"><a href="#cb41-18"></a>  convergence                  y x              model mean_fun  err_dist         H         c</span>
<span id="cb41-19"><a href="#cb41-19"></a><span class="dv">1</span>           <span class="dv">0</span> constant_bernoulli x constant_bernoulli constant bernoulli <span class="fl">0.9140000</span>        <span class="ot">NA</span></span>
<span id="cb41-20"><a href="#cb41-20"></a><span class="dv">2</span>           <span class="dv">0</span> constant_bernoulli x  uniform_bernoulli  uniform bernoulli <span class="fl">0.9140000</span> <span class="fl">-4.092677</span></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="dv">3</span>           <span class="dv">0</span>  uniform_bernoulli x constant_bernoulli constant bernoulli <span class="fl">0.3580000</span>        <span class="ot">NA</span></span>
<span id="cb41-22"><a href="#cb41-22"></a><span class="dv">4</span>           <span class="dv">0</span>  uniform_bernoulli x  uniform_bernoulli  uniform bernoulli <span class="fl">0.9132653</span> <span class="fl">30.345761</span></span>
<span id="cb41-23"><a href="#cb41-23"></a>          d npar       nll      AIC     AICc      BIC</span>
<span id="cb41-24"><a href="#cb41-24"></a><span class="dv">1</span>        <span class="ot">NA</span>    <span class="dv">1</span> <span class="fl">146.59213</span> <span class="fl">295.1843</span> <span class="fl">295.1923</span> <span class="fl">299.3989</span></span>
<span id="cb41-25"><a href="#cb41-25"></a><span class="dv">2</span> <span class="fl">108.35812</span>    <span class="dv">3</span> <span class="fl">146.59213</span> <span class="fl">299.1843</span> <span class="fl">299.2327</span> <span class="fl">311.8281</span></span>
<span id="cb41-26"><a href="#cb41-26"></a><span class="dv">3</span>        <span class="ot">NA</span>    <span class="dv">1</span> <span class="fl">326.12939</span> <span class="fl">654.2588</span> <span class="fl">654.2668</span> <span class="fl">658.4734</span></span>
<span id="cb41-27"><a href="#cb41-27"></a><span class="dv">4</span>  <span class="fl">69.92516</span>    <span class="dv">3</span>  <span class="fl">57.80379</span> <span class="fl">121.6076</span> <span class="fl">121.6560</span> <span class="fl">134.2514</span></span></code></pre></div>
<p>Alternatively, one can fit multiple models to real data. The <tt>msenlm.best</tt> function picks the best model for each response variable using the given criteria. The <tt>summary</tt> function summarises the fitted models.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>Models &lt;-<span class="st"> </span><span class="kw">set_models</span> (<span class="dt">mean_fun=</span><span class="st">"gaussian"</span>, <span class="dt">err_dist=</span><span class="kw">c</span>(<span class="st">"zip"</span>, <span class="st">"zinb"</span>))</span>
<span id="cb42-2"><a href="#cb42-2"></a>Fits   &lt;-<span class="st"> </span><span class="kw">msenlm</span> (<span class="dt">models=</span>Models, <span class="dt">data=</span>haul, <span class="dt">xvar=</span><span class="st">"depth"</span>, </span>
<span id="cb42-3"><a href="#cb42-3"></a>                  <span class="dt">yvar=</span><span class="kw">c</span>(<span class="st">"Albatrossia.pectoralis"</span>, <span class="st">"Sebastolobus.altivelis"</span>))</span>
<span id="cb42-4"><a href="#cb42-4"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="dv">1</span> gaussian      zip         <span class="ot">NA</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="dv">2</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="dv">1</span> gaussian      zip         <span class="ot">NA</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>  mean_fun err_dist binomial_n</span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="dv">2</span> gaussian     zinb         <span class="ot">NA</span></span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="kw">summary</span>(Fits)</span>
<span id="cb42-13"><a href="#cb42-13"></a>  convergence                      y     x         model mean_fun err_dist          H         m</span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="dv">1</span>           <span class="dv">0</span> Albatrossia.pectoralis depth  gaussian_zip gaussian      zip   <span class="fl">58.11781</span> <span class="fl">1537.8453</span></span>
<span id="cb42-15"><a href="#cb42-15"></a><span class="dv">2</span>           <span class="dv">0</span> Albatrossia.pectoralis depth gaussian_zinb gaussian     zinb   <span class="fl">29.74407</span> <span class="fl">1145.7279</span></span>
<span id="cb42-16"><a href="#cb42-16"></a><span class="dv">3</span>           <span class="dv">0</span> Sebastolobus.altivelis depth  gaussian_zip gaussian      zip  <span class="fl">817.53123</span>  <span class="fl">917.8020</span></span>
<span id="cb42-17"><a href="#cb42-17"></a><span class="dv">4</span>           <span class="dv">0</span> Sebastolobus.altivelis depth gaussian_zinb gaussian     zinb <span class="fl">1448.37043</span>  <span class="fl">900.6961</span></span>
<span id="cb42-18"><a href="#cb42-18"></a>         s           pi      phi npar        nll       AIC      AICc       BIC</span>
<span id="cb42-19"><a href="#cb42-19"></a><span class="dv">1</span> <span class="fl">369.7516</span> <span class="fl">4.303492e-01</span>       <span class="ot">NA</span>    <span class="dv">4</span>  <span class="fl">3022.4148</span>  <span class="fl">6052.830</span>  <span class="fl">6052.867</span>  <span class="fl">6072.739</span></span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="dv">2</span> <span class="fl">213.8882</span> <span class="fl">1.378740e-13</span> <span class="fl">3.044749</span>    <span class="dv">5</span>   <span class="fl">927.2072</span>  <span class="fl">1864.414</span>  <span class="fl">1864.471</span>  <span class="fl">1889.301</span></span>
<span id="cb42-21"><a href="#cb42-21"></a><span class="dv">3</span> <span class="fl">225.5626</span> <span class="fl">5.954216e-01</span>       <span class="ot">NA</span>    <span class="dv">4</span> <span class="fl">36950.0517</span> <span class="fl">73908.103</span> <span class="fl">73908.141</span> <span class="fl">73928.013</span></span>
<span id="cb42-22"><a href="#cb42-22"></a><span class="dv">4</span> <span class="fl">164.9688</span> <span class="fl">1.548443e-01</span> <span class="fl">1.575696</span>    <span class="dv">5</span>  <span class="fl">2910.8488</span>  <span class="fl">5831.698</span>  <span class="fl">5831.754</span>  <span class="fl">5856.584</span></span>
<span id="cb42-23"><a href="#cb42-23"></a><span class="kw">summary</span>(<span class="kw">msenlm.best</span>(Fits, <span class="dt">best=</span><span class="st">"AICc"</span>))</span>
<span id="cb42-24"><a href="#cb42-24"></a>  convergence                      y     x         model mean_fun err_dist          H         m</span>
<span id="cb42-25"><a href="#cb42-25"></a><span class="dv">1</span>           <span class="dv">0</span> Albatrossia.pectoralis depth gaussian_zinb gaussian     zinb   <span class="fl">29.74407</span> <span class="fl">1145.7279</span></span>
<span id="cb42-26"><a href="#cb42-26"></a><span class="dv">2</span>           <span class="dv">0</span> Sebastolobus.altivelis depth gaussian_zinb gaussian     zinb <span class="fl">1448.37043</span>  <span class="fl">900.6961</span></span>
<span id="cb42-27"><a href="#cb42-27"></a>         s           pi      phi npar       nll      AIC     AICc      BIC</span>
<span id="cb42-28"><a href="#cb42-28"></a><span class="dv">1</span> <span class="fl">213.8882</span> <span class="fl">1.378740e-13</span> <span class="fl">3.044749</span>    <span class="dv">5</span>  <span class="fl">927.2072</span> <span class="fl">1864.414</span> <span class="fl">1864.471</span> <span class="fl">1889.301</span></span>
<span id="cb42-29"><a href="#cb42-29"></a><span class="dv">2</span> <span class="fl">164.9688</span> <span class="fl">1.548443e-01</span> <span class="fl">1.575696</span>    <span class="dv">5</span> <span class="fl">2910.8488</span> <span class="fl">5831.698</span> <span class="fl">5831.754</span> <span class="fl">5856.584</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="initial-parameter-estimates">Initial Parameter Estimates<a class="anchor" aria-label="anchor" href="#initial-parameter-estimates"></a>
</h2>
<p>The maximum likelihood estimation needs good initial parameter estimates to work well. In this section we describe the methods used to obtain these estimates.</p>
<div class="section level3">
<h3 id="smoothing-spline">Smoothing spline<a class="anchor" aria-label="anchor" href="#smoothing-spline"></a>
</h3>
<p>Given data <span class="math inline">\({x_i, y_i}\)</span>, we first approximate the mean function, using a smoothing spline (<tt>stats::smooth.spline</tt>) resulting in a set of points <span class="math inline">\({x_i,\mu_i}\)</span>. Since our data are non-negative, any negative values of the spline (<span class="math inline">\(\mu_i\)</span> values) are set to zero.</p>
<p>From this we extract the following estimates.</p>
<ul>
<li>
<span class="math inline">\(H\)</span>: The maximum value (height) of the spline.</li>
<li>
<span class="math inline">\(m\)</span>: The location (<span class="math inline">\(x\)</span>) of the maxium height. If the maximum height is reached in multiple locations we average these locations.</li>
<li>
<span class="math inline">\(s\)</span>: This is a conservative estimate of the spread of the data. We take one quarter of the range of the <span class="math inline">\(x\)</span>-values where the <span class="math inline">\(\mu\)</span>-value is positive.</li>
</ul>
</div>
<div class="section level3">
<h3 id="error-parameter-estimates">Error parameter estimates<a class="anchor" aria-label="anchor" href="#error-parameter-estimates"></a>
</h3>
<p>The table below list the parameters of each error model.</p>
<table class="table">
<thead><tr class="header">
<th>Model</th>
<th align="center">Parameters</th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>bernoulli</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>binomial.count</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>binomial.prop</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>poisson</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>negbin</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>zip</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\pi\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>zinb</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\pi\)</span></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>zipl</td>
<td align="center"><span class="math inline">\(\gamma_0\)</span></td>
<td align="center"><span class="math inline">\(\gamma_1\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>zinbl</td>
<td align="center"><span class="math inline">\(\gamma_0\)</span></td>
<td align="center"><span class="math inline">\(\gamma_1\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>zipl.mu</td>
<td align="center"><span class="math inline">\(\gamma_0\)</span></td>
<td align="center"><span class="math inline">\(\gamma_1\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>zinbl.mu</td>
<td align="center"><span class="math inline">\(\gamma_0\)</span></td>
<td align="center"><span class="math inline">\(\gamma_1\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>gaussian</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\sigma\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>tweedie</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\rho\)</span></td>
</tr>
<tr class="even">
<td>zig</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\pi\)</span></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>zigl</td>
<td align="center"><span class="math inline">\(\gamma_0\)</span></td>
<td align="center"><span class="math inline">\(\gamma_1\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>zigl.mu</td>
<td align="center"><span class="math inline">\(\gamma_0\)</span></td>
<td align="center"><span class="math inline">\(\gamma_1\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>ziig</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\pi\)</span></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>ziigl</td>
<td align="center"><span class="math inline">\(\gamma_0\)</span></td>
<td align="center"><span class="math inline">\(\gamma_1\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>tab</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\sigma\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>zitab</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\pi\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(\sigma\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="phi">
<span class="math inline">\(\phi\)</span><a class="anchor" aria-label="anchor" href="#phi"></a>
</h4>
<p>The dispersion parameter, <span class="math inline">\(\phi\)</span>, is estimated as follows.</p>
<ul>
<li>Find the residuals, <span class="math inline">\(r_i\)</span>, of the data <span class="math inline">\(y_i\)</span> around the spline fit <span class="math inline">\(\mu_i\)</span>.</li>
<li>Fit another smoothing spline to the squared residuals versus <span class="math inline">\(x_i\)</span>. Call these points <span class="math inline">\(v_i\)</span>.</li>
<li>Set any negative values of <span class="math inline">\(v_i\)</span> to zero.</li>
<li>Estimate <span class="math inline">\(\phi\)</span> as the median of the absolute value of <span class="math inline">\((v_i - \mu_i)/\mu^2\)</span>. (This is motivated by the mean/variance relationship of a negative binomial).</li>
</ul>
</div>
<div class="section level4">
<h4 id="sigma">
<span class="math inline">\(\sigma\)</span><a class="anchor" aria-label="anchor" href="#sigma"></a>
</h4>
<p>For a guassian error distribution, <span class="math inline">\(\sigma\)</span> is a standard deviation and is estimated as the standard deviation of <span class="math inline">\(y_i - \mu_i\)</span>.</p>
<p>For a tail-adjusted beta, and a zero-inflated tail adjusted beta, <span class="math inline">\(\sigma\)</span> is a shape parameter which is estimated using the method of moments.</p>
<ul>
<li>Let <span class="math inline">\(V\)</span> be the variance of <span class="math inline">\(y_i - \mu_i\)</span>.</li>
<li>Let <span class="math inline">\(S_i = V/(\mu_i*(1-mu_i) - V)\)</span>.</li>
<li>Estimate <span class="math inline">\(\sigma\)</span> with the average of the non-negative <span class="math inline">\(S_i\)</span>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="pi">
<span class="math inline">\(\pi\)</span><a class="anchor" aria-label="anchor" href="#pi"></a>
</h4>
<p>The parameter <span class="math inline">\(\pi\)</span> is usually estimated to be the proportion of zeros in the data (<span class="math inline">\(y\)</span>) minus the expected number of zeros due to the spike. For the zitab model, <span class="math inline">\(\pi\)</span> was estimated using the method of moments.</p>
<p>If the final estimate of <span class="math inline">\(\pi\)</span> is less than 0.01 then it is set to 0.01.</p>
</div>
<div class="section level4">
<h4 id="gamma_0">
<span class="math inline">\(\gamma_0\)</span><a class="anchor" aria-label="anchor" href="#gamma_0"></a>
</h4>
<p>Given an estimate of <span class="math inline">\(\pi\)</span> as above we estimate the zero spike proportion intercept parameter, <span class="math inline">\(\gamma_0\)</span>, with <span class="math inline">\(\log (\pi/(1 - \pi))\)</span>.</p>
</div>
<div class="section level4">
<h4 id="gamma_1">
<span class="math inline">\(\gamma_1\)</span><a class="anchor" aria-label="anchor" href="#gamma_1"></a>
</h4>
<p>The zero spike proportion slope parameter, <span class="math inline">\(\gamma_1\)</span>, is initially set to 0.</p>
</div>
<div class="section level4">
<h4 id="rho">
<span class="math inline">\(\rho\)</span><a class="anchor" aria-label="anchor" href="#rho"></a>
</h4>
<p>The tweedie exponent parameter, <span class="math inline">\(\rho\)</span>, is initially set to 1.1.</p>
</div>
</div>
<div class="section level3">
<h3 id="mean-function-parameters">Mean function parameters<a class="anchor" aria-label="anchor" href="#mean-function-parameters"></a>
</h3>
<p>The table below list the parameters of each mean function.</p>
<table class="table">
<thead><tr class="header">
<th>Model</th>
<th align="center">Parameters</th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
<th align="center"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>constant</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>uniform</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(c\)</span></td>
<td align="center"><span class="math inline">\(d\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>beta</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(c\)</span></td>
<td align="center"><span class="math inline">\(d\)</span></td>
<td align="center"><span class="math inline">\(u\)</span></td>
<td align="center"><span class="math inline">\(v\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>gaussian</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center"><span class="math inline">\(s\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>mixgaussian</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center">
<span class="math inline">\(m_1\)</span> <span class="math inline">\(m_2\)</span>
</td>
<td align="center">
<span class="math inline">\(s_1\)</span> <span class="math inline">\(s_2\)</span>
</td>
<td align="center"><span class="math inline">\(\alpha\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>mixgaussian.equal</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center">
<span class="math inline">\(m_1\)</span> <span class="math inline">\(m_2\)</span>
</td>
<td align="center"><span class="math inline">\(s\)</span></td>
<td align="center"><span class="math inline">\(\alpha\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>sech</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center"><span class="math inline">\(s\)</span></td>
<td align="center"><span class="math inline">\(r\)</span></td>
<td align="center"><span class="math inline">\(p\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>sech.p1</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center"><span class="math inline">\(s\)</span></td>
<td align="center"><span class="math inline">\(r\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>sech.r0p1</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center"><span class="math inline">\(s\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>hofV</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center">
<span class="math inline">\(w_1\)</span> <span class="math inline">\(w_2\)</span>
</td>
<td align="center"><span class="math inline">\(k\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>hofII</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center"><span class="math inline">\(\omega_0\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>hofIV</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center"><span class="math inline">\(\omega\)</span></td>
<td align="center"><span class="math inline">\(k\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>hofIVb</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center"><span class="math inline">\(\omega\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>hofVb</td>
<td align="center"><span class="math inline">\(H\)</span></td>
<td align="center"><span class="math inline">\(m\)</span></td>
<td align="center">
<span class="math inline">\(\omega_1\)</span> <span class="math inline">\(\omega_2\)</span>
</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="h">H<a class="anchor" aria-label="anchor" href="#h"></a>
</h4>
<p>The estimate of <span class="math inline">\(H\)</span> is the average of <span class="math inline">\(y_i\)</span>. When the error distribution is bernoulli, tab, or zitab (i.e. <span class="math inline">\(y_i\)</span> is 0-1), <span class="math inline">\(H\)</span> is thresholded to a maximum value of 0.9.</p>
</div>
<div class="section level4">
<h4 id="uniform-beta">Uniform / Beta<a class="anchor" aria-label="anchor" href="#uniform-beta"></a>
</h4>
<p>The boundary parameters <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> are estimated to be the minimum and maximum values of <span class="math inline">\(x_i\)</span> respectively, conditional on the <span class="math inline">\(y_i\)</span> being positive.</p>
<p>The beta parameters <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are estimated using the standard method of moments.</p>
</div>
<div class="section level4">
<h4 id="gaussian">Gaussian<a class="anchor" aria-label="anchor" href="#gaussian"></a>
</h4>
<p>The <span class="math inline">\(m\)</span> and <span class="math inline">\(s\)</span> parameters are estimated from the smoothing spline above.</p>
</div>
<div class="section level4">
<h4 id="mixgaussianmixgaussian-equal">Mixgaussian/Mixgaussian.equal<a class="anchor" aria-label="anchor" href="#mixgaussianmixgaussian-equal"></a>
</h4>
<p>The estimates of the means <span class="math inline">\(m_1\)</span> and <span class="math inline">\(m_2\)</span> are taken to be the 35th and 65th percentiles of the <span class="math inline">\(x\)</span> values (when <span class="math inline">\(y\)</span> is positive). This is largely independent of the <span class="math inline">\(y\)</span> data but is a simple method for keeping the two modes from converging too early in the fitting algorithm.</p>
<p>The standard deviations <span class="math inline">\(s\)</span>, or <span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span>, are taken to be the estimate of <span class="math inline">\(s\)</span> from the smoothing spline.</p>
<p>The mixing parameter, <span class="math inline">\(\alpha\)</span>, is set to 0.5.</p>
</div>
<div class="section level4">
<h4 id="sech-sech-p1-sech-r0p1">Sech, Sech.p1, Sech.r0p1<a class="anchor" aria-label="anchor" href="#sech-sech-p1-sech-r0p1"></a>
</h4>
<p>The mode location parameter, <span class="math inline">\(m\)</span>, is estimated from the smoothing spline.</p>
<p>The skewness parameter, <span class="math inline">\(r\)</span>, is set to 0.</p>
<p>The peakedness parameter, <span class="math inline">\(p\)</span>, is set to 1.</p>
<p>For the spread parameter, <span class="math inline">\(s\)</span>: let <span class="math inline">\(s_x\)</span> be the standard deviation of the <span class="math inline">\(x\)</span> values weighted by the <span class="math inline">\(y\)</span> values, and let <span class="math inline">\(s_0\)</span> be the smallest non-zero distance between the <span class="math inline">\(x\)</span> values. The initial estimate of <span class="math inline">\(s\)</span> is taken to me the maximum of <span class="math inline">\(s_x\)</span> and <span class="math inline">\(s_0\)</span>.</p>
</div>
<div class="section level4">
<h4 id="hofiv-hofivb-hofv-hofvb">HofIV, HofIVb, HofV, HofVb<a class="anchor" aria-label="anchor" href="#hofiv-hofivb-hofv-hofvb"></a>
</h4>
<p>The growth rate parameters, <span class="math inline">\(\omega\)</span>, <span class="math inline">\(\omega_1\)</span>, and <span class="math inline">\(\omega_2\)</span> are estimated to be <span class="math inline">\(4\exp(-0.5)/s\)</span> where <span class="math inline">\(s\)</span> is the spread estimate from the smoothing spline.</p>
<p><span class="math inline">\(k\)</span> is taken to be 1.</p>
</div>
<div class="section level4">
<h4 id="hofii">HofII<a class="anchor" aria-label="anchor" href="#hofii"></a>
</h4>
<p>The slope of the hofII curve at <span class="math inline">\(x=m\)</span> equals <span class="math inline">\(H*\omega_0/4\)</span>. We use this fact to estimate this slope by considering points at <span class="math inline">\(x= m - (1/w0)\)</span>, and <span class="math inline">\(x= m + (1/w0)\)</span> and then solving to estimate <span class="math inline">\(\omega_0\)</span>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniel Walsh, Marti Anderson, Andrew Punnett, Nurudeen Adegoke.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
